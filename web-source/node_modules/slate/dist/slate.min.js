!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("immutable")):"function"==typeof define&&define.amd?define(["exports","immutable"],t):t(e.Slate={},e.Immutable)}(this,function(e,t){"use strict";var r=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)};function n(e){return!0===r(e)&&"[object Object]"===Object.prototype.toString.call(e)}var o=function(e){var t,r;return!1!==n(e)&&("function"==typeof(t=e.constructor)&&(!1!==n(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf")))},a=void 0,i=void 0;function s(){a=0,i=function(){return""+a++}}s();var u={create:function(e){if(null==e)return i();if("string"==typeof e)return e;throw new Error("Keys must be strings, but you passed: "+e)},setGenerator:function(e){i=e},resetGenerator:s};function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!e){var r=console.warn||console.log;r("Warning: "+t)}}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},v=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},y=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},p=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},k=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},g=function(){function e(){f(this,e)}return v(e,null,[{key:"create",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.Map.isMap(r))return r;if(o(r))return e.fromJSON(r);throw new Error("`Data.create` only accepts objects or maps, but you passed it: "+r)}},{key:"fromJSON",value:function(e){return new t.Map(e)}}]),e}();g.fromJS=g.fromJSON;var b={data:void 0,key:void 0,nodes:void 0},A=function(e){function r(){return f(this,r),p(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return h(r,e),v(r,[{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,data:this.data.toJSON(),nodes:this.nodes.toArray().map(function(t){return t.toJSON(e)})};return e.preserveKeys&&(t.key=this.key),t}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isDocument(e))return e;if((t.List.isList(e)||Array.isArray(e))&&(e={nodes:e}),o(e))return r.fromJSON(e);throw new Error("`Document.create` only accepts objects, arrays, lists or documents, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(r.isDocument(e))return e;var n=e.data,o=void 0===n?{}:n,a=e.key,i=void 0===a?u.create():a,s=e.nodes,c=void 0===s?[]:s;return new r({key:i,data:new t.Map(o),nodes:D.createList(c)})}}]),r}(t.Record(b)),x={data:void 0,key:void 0,nodes:void 0,type:void 0},O=function(e){function r(){return f(this,r),p(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return h(r,e),v(r,[{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,type:this.type,data:this.data.toJSON(),nodes:this.nodes.toArray().map(function(t){return t.toJSON(e)})};return e.preserveKeys&&(t.key=this.key),t}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isInline(e))return e;if("string"==typeof e&&(e={type:e}),o(e))return r.fromJSON(e);throw new Error("`Inline.create` only accepts objects, strings or inlines, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e)||Array.isArray(e))return new t.List(e.map(r.create));throw new Error("`Inline.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(r.isInline(e))return e;var n=e.data,o=void 0===n?{}:n,a=e.key,i=void 0===a?u.create():a,s=e.nodes,c=void 0===s?[]:s,l=e.type;if("string"!=typeof l)throw new Error("`Inline.fromJS` requires a `type` string.");return new r({key:i,type:l,data:new t.Map(o),nodes:D.createList(c)})}},{key:"isInlineList",value:function(e){return t.List.isList(e)&&e.every(function(e){return r.isInline(e)})}}]),r}(t.Record(x)),T={data:void 0,type:void 0},N=function(e){function r(){return f(this,r),p(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return h(r,e),v(r,[{key:"toJSON",value:function(){return{object:this.object,type:this.type,data:this.data.toJSON()}}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isMark(e))return e;if("string"==typeof e&&(e={type:e}),o(e))return r.fromJSON(e);throw new Error("`Mark.create` only accepts objects, strings or marks, but you passed it: "+e)}},{key:"createSet",value:function(e){if(t.Set.isSet(e)||Array.isArray(e))return new t.Set(e.map(r.create));if(null==e)return t.Set();throw new Error("`Mark.createSet` only accepts sets, arrays or null, but you passed it: "+e)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isMark(e))return{data:e.data,type:e.type};if("string"==typeof e)return{type:e};if(o(e)){var t={};return"type"in e&&(t.type=e.type),"data"in e&&(t.data=g.create(e.data)),t}throw new Error("`Mark.createProperties` only accepts objects, strings or marks, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var n=e.data,o=void 0===n?{}:n,a=e.type;if("string"!=typeof a)throw new Error("`Mark.fromJS` requires a `type` string.");return new r({type:a,data:new t.Map(o)})}},{key:"isMarkSet",value:function(e){return t.Set.isSet(e)&&e.every(function(e){return r.isMark(e)})}}]),r}(t.Record(T)),w={marks:void 0,text:void 0},_=function(e){function r(){return f(this,r),p(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return h(r,e),v(r,[{key:"updateMark",value:function(e,t){var r=this.marks;if(t.equals(e))return this;if(!r.has(e))return this;var n=r.withMutations(function(r){r.remove(e).add(t)});return this.set("marks",n)}},{key:"addMark",value:function(e){var t=this.marks;return this.set("marks",t.add(e))}},{key:"addMarks",value:function(e){var t=this.marks;return this.set("marks",t.union(e))}},{key:"removeMark",value:function(e){var t=this.marks;return this.set("marks",t.remove(e))}},{key:"toJSON",value:function(){return{object:this.object,text:this.text,marks:this.marks.toArray().map(function(e){return e.toJSON()})}}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isLeaf(e))return e;if("string"==typeof e&&(e={text:e}),o(e))return r.fromJSON(e);throw new Error("`Leaf.create` only accepts objects, strings or leaves, but you passed it: "+e)}},{key:"createLeaves",value:function(e){if(e.size<=1)return e;var r=!1,n=t.List().withMutations(function(t){e.findLast(function(e,n){var o=t.first();if(o){if(o.marks.equals(e.marks))return r=!0,void t.set(0,o.set("text",""+e.text+o.text));if(""===o.text)return r=!0,void t.set(0,e);if(""===e.text)return void(r=!0)}t.unshift(e)})});return r?n:e}},{key:"splitLeaves",value:function(e,r){if(r<0)return[t.List(),e];if(0===e.size)return[t.List(),t.List()];var n=0,o=-1,a=void 0,i=void 0;return e.find(function(e){o++;var t=n,s=e.text;if((n+=s.length)<r)return!1;if(t>r)return!1;var u=r-t;return a=e.set("text",s.slice(0,u)),i=e.set("text",s.slice(u)),!0}),a?""===a.text?0===o?[t.List.of(a),e]:[e.take(o),e.skip(o)]:""===i.text?o===e.size-1?[e,t.List.of(i)]:[e.take(o+1),e.skip(o+1)]:[e.take(o).push(a),e.skip(o+1).unshift(i)]:[e,t.List()]}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e)||Array.isArray(e))return new t.List(e.map(r.create));throw new Error("`Leaf.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var n=e.text,o=void 0===n?"":n,a=e.marks,i=void 0===a?[]:a;return new r({text:o,marks:t.Set(i.map(N.fromJSON))})}},{key:"isLeafList",value:function(e){return t.List.isList(e)&&e.every(function(e){return r.isLeaf(e)})}}]),r}(t.Record(w)),S=!0,F=0,E={},B={},j=void 0;function P(e,t){var r=function(t){var r=e[t];if(!r)throw new Error('Object does not have a property named "'+t+'".');e[t]=function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];if(!S)return r.apply(this,n);F!==this.__cache_key&&(this.__cache_key=F,this.__cache=new Map,this.__cache_no_args={}),this.__cache||(this.__cache=new Map),this.__cache_no_args||(this.__cache_no_args={});var a=0!==n.length,i=void 0,s=void 0;if(a?(s=[t].concat(n),i=function(e,t){var r=!0,n=!1,o=void 0;try{for(var a,i=t[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value;if((e=e.get(s))===j)return j}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}return e.get(E)}(this.__cache,s)):i=this.__cache_no_args[t],i!==j)return i===B?void 0:i;var u=r.apply(this,n),c=void 0===u?B:u;return a?this.__cache=function(e,t,r){var n=e,o=void 0,a=!0,i=!1,s=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;(o=n.get(l))===j&&(o=new Map,n.set(l,o)),n=o}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}return o.set(E,r),e}(this.__cache,s,c):this.__cache_no_args[t]=c,u}},n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){r(i.value)}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}}function C(){++F>=Number.MAX_SAFE_INTEGER&&(F=0)}function L(e){S=e}var z={leaves:void 0,key:void 0},M=function(e){function r(){return f(this,r),p(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return h(r,e),v(r,[{key:"searchLeafAtOffset",value:function(e){var t=0,r=0,n=-1;return{leaf:this.leaves.find(function(o){return n++,(t=(r=t)+o.text.length)>=e}),endOffset:t,index:n,startOffset:r}}},{key:"addMark",value:function(e,r,n){var o=t.Set.of(n);return this.addMarks(e,r,o)}},{key:"addMarks",value:function(e,r,n){if(""===this.text&&0===r&&0===e){var o=this.leaves.first();if(!o)return this.set("leaves",t.List.of(_.fromJSON({text:"",marks:n})));var a=o.addMarks(n);return a===o?this:this.set("leaves",t.List.of(a))}if(""===this.text)return this;if(0===r)return this;if(e>=this.text.length)return this;var i=_.splitLeaves(this.leaves,e),s=k(i,2),u=s[0],c=s[1],l=_.splitLeaves(c,r),f=k(l,2),v=f[0],d=f[1],h=u.concat(v.map(function(e){return e.addMarks(n)}),d);return this.setLeaves(h)}},{key:"getLeaves",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.leaves;if(0===n.size)return t.List.of(_.create({}));if(!r||0===r.length)return n;if(0===this.text.length)return n;var o=this.key;return r.forEach(function(t){var r=t.start,a=t.end,i=t.mark,s=r.key==o,u=a.key==o;if(s&&u){var c=s?r.offset:0,l=u?a.offset-c:e.text.length-c;if(l<1)return;if(c>=e.text.length)return;if(0!==c||l<e.text.length){var f=_.splitLeaves(n,c),v=k(f,2),d=v[0],h=v[1],y=_.splitLeaves(h,l),p=k(y,2),m=p[0],g=p[1];return void(n=d.concat(m.map(function(e){return e.addMark(i)}),g))}}n=n.map(function(e){return e.addMark(i)})}),n===this.leaves?n:_.createLeaves(n)}},{key:"getActiveMarksBetweenOffsets",value:function(e,r){if(e<=0&&r>=this.text.length)return this.getActiveMarks();if(e>=r)return t.Set();if(""===this.text)return this.getActiveMarks();var n=null,o=0;return this.leaves.forEach(function(t){var a=o;if(!((o=a+t.text.length)<=e)){if(a>=r)return!1;if(n)return(n=n.intersect(t.marks))&&n.size,!1;n=t.marks}}),n||t.Set()}},{key:"getActiveMarks",value:function(){var e=this;if(0===this.leaves.size)return t.Set();var r=this.leaves.first().marks;return 0===r.size?r:r.toOrderedSet().withMutations(function(t){e.leaves.forEach(function(e){if(t.intersect(e.marks),0===t.size)return!1})})}},{key:"getMarksBetweenOffsets",value:function(e,r){if(e<=0&&r>=this.text.length)return this.getMarks();if(e>=r)return t.Set();if(""===this.text)return this.getActiveMarks();var n=null,o=0;return this.leaves.forEach(function(t){var a=o;if(!((o=a+t.text.length)<=e))return!(a>=r)&&void(n=n?n.union(t.marks):t.marks)}),n||t.Set()}},{key:"getMarks",value:function(){var e=this.getMarksAsArray();return new t.OrderedSet(e)}},{key:"getMarksAsArray",value:function(){if(0===this.leaves.size)return[];var e=this.leaves.first().marks;if(1===this.leaves.size)return e.toArray();var t=[];return this.leaves.forEach(function(e){t.push(e.marks.toArray())}),Array.prototype.concat.apply(e.toArray(),t)}},{key:"getMarksAtIndex",value:function(e){var r=this.searchLeafAtOffset(e).leaf;return r?r.marks:t.Set()}},{key:"insertText",value:function(e,r,n){if(""===this.text)return this.set("leaves",t.List.of(_.create({text:r,marks:n})));if(0===r.length)return this;n||(n=t.Set());var o=this.searchLeafAtOffset(e),a=o.startOffset,i=o.leaf,s=o.index,u=e-a,c=i.text.slice(0,u),l=i.text.slice(u),f=this.leaves;if(i.marks.equals(n))return this.set("leaves",f.set(s,i.set("text",c+r+l)));var v=f.splice(s,1,i.set("text",c),_.create({text:r,marks:n}),i.set("text",l));return this.setLeaves(v)}},{key:"removeMark",value:function(e,r,n){if(""===this.text&&0===e&&0===r){var o=this.leaves.first();if(!o)return this;var a=o.removeMark(n);return a===o?this:this.set("leaves",t.List.of(a))}if(r<=0)return this;if(e>=this.text.length)return this;var i=_.splitLeaves(this.leaves,e),s=k(i,2),u=s[0],c=s[1],l=_.splitLeaves(c,r),f=k(l,2),v=f[0],d=f[1],h=u.concat(v.map(function(e){return e.removeMark(n)}),d);return this.setLeaves(h)}},{key:"removeText",value:function(e,r){if(r<=0)return this;if(e>=this.text.length)return this;if(1===r){var n=this.searchLeafAtOffset(e+1),o=n.leaf,a=n.index,i=e-n.startOffset;if(o){if(1===o.text.length){var s=this.leaves.remove(a);return this.setLeaves(s)}var u=o.text.slice(0,i)+o.text.slice(i+r);if(u.length>0)return this.set("leaves",this.leaves.set(a,o.set("text",u)))}}var c=_.splitLeaves(this.leaves,e),l=k(c,2),f=l[0],v=l[1],d=_.splitLeaves(v,r)[1],h=_.createLeaves(f.concat(d));if(1===h.size){var y=h.first();if(""===y.text)return this.set("leaves",t.List.of(y.set("marks",this.getActiveMarks())))}return this.set("leaves",h)}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,leaves:this.getLeaves().toArray().map(function(e){return e.toJSON()})};return e.preserveKeys&&(t.key=this.key),t}},{key:"updateMark",value:function(e,r,n,o){var a=n.merge(o);if(""===this.text&&0===r&&0===e){var i=this.leaves.first();if(!i)return this;var s=i.updateMark(n,a);return s===i?this:this.set("leaves",t.List.of(s))}if(r<=0)return this;if(e>=this.text.length)return this;var u=_.splitLeaves(this.leaves,e),c=k(u,2),l=c[0],f=c[1],v=_.splitLeaves(f,r),d=k(v,2),h=d[0],y=d[1],p=l.concat(h.map(function(e){return e.updateMark(n,a)}),y);return this.setLeaves(p)}},{key:"splitText",value:function(e){var t=_.splitLeaves(this.leaves,e);return[this.set("leaves",t[0]),this.set("leaves",t[1]).regenerateKey()]}},{key:"mergeText",value:function(e){var t=this.leaves.concat(e.leaves);return this.setLeaves(t)}},{key:"setLeaves",value:function(e){var r=_.createLeaves(e);if(1===r.size){var n=r.first();if((!n.marks||0===n.marks.size)&&""===n.text)return this.set("leaves",t.List())}return this.set("leaves",_.createLeaves(e))}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(r.isText(e))return e;if("string"==typeof e&&(e={leaves:[{text:e}]}),o(e)){if(e.text){var t=e,n=t.text,a=t.marks;e={key:t.key,leaves:[{text:n,marks:a}]}}return r.fromJSON(e)}throw new Error("`Text.create` only accepts objects, arrays, strings or texts, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e)||Array.isArray(e))return new t.List(e.map(r.create));throw new Error("`Text.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(r.isText(e))return e;var n=e.key,o=void 0===n?u.create():n,a=e.leaves;if(a||(e.ranges?(c(!1,"As of slate@0.27.0, the `ranges` property of Slate objects has been renamed to `leaves`."),a=e.ranges):a=t.List()),Array.isArray(a))a=t.List(a.map(function(e){return _.create(e)}));else{if(!t.List.isList(a))throw new Error("leaves must be either Array or Immutable.List");a=a.map(function(e){return _.create(e)})}return new r({leaves:_.createLeaves(a),key:o})}},{key:"isTextList",value:function(e){return t.List.isList(e)&&e.every(function(e){return r.isText(e)})}}]),r}(t.Record(z));P(M.prototype,["getActiveMarks","getMarks","getMarksAsArray"]);var D=function(){function e(){f(this,e)}return v(e,null,[{key:"create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.isNode(t))return t;if(o(t)){var r=t.object;switch(!r&&t.kind&&(c(!1,"As of slate@0.32.0, the `kind` property of Slate objects has been renamed to `object`."),r=t.kind),r){case"block":return I.create(t);case"document":return A.create(t);case"inline":return O.create(t);case"text":return M.create(t);default:throw new Error("`Node.create` requires a `object` string.")}}throw new Error("`Node.create` only accepts objects or nodes but you passed it: "+t)}},{key:"createList",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(r)||Array.isArray(r))return t.List(r.map(e.create));throw new Error("`Node.createList` only accepts lists or arrays, but you passed it: "+r)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(I.isBlock(e)||O.isInline(e))return{data:e.data,type:e.type};if("string"==typeof e)return{type:e};if(o(e)){var t={};return"type"in e&&(t.type=e.type),"data"in e&&(t.data=g.create(e.data)),t}throw new Error("`Node.createProperties` only accepts objects, strings, blocks or inlines, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var t=e.object;switch(!t&&e.kind&&(c(!1,"As of slate@0.32.0, the `kind` property of Slate objects has been renamed to `object`."),t=e.kind),t){case"block":return I.fromJSON(e);case"document":return A.fromJSON(e);case"inline":return O.fromJSON(e);case"text":return M.fromJSON(e);default:throw new Error("`Node.fromJSON` requires an `object` of either 'block', 'document', 'inline' or 'text', but you passed: "+e)}}},{key:"isNode",value:function(e){return I.isBlock(e)||A.isDocument(e)||O.isInline(e)||M.isText(e)}},{key:"isNodeList",value:function(r){return t.List.isList(r)&&r.every(function(t){return e.isNode(t)})}}]),e}(),R={data:void 0,key:void 0,nodes:void 0,type:void 0},I=function(e){function r(){return f(this,r),p(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return h(r,e),v(r,[{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,type:this.type,data:this.data.toJSON(),nodes:this.nodes.toArray().map(function(t){return t.toJSON(e)})};return e.preserveKeys&&(t.key=this.key),t}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isBlock(e))return e;if("string"==typeof e&&(e={type:e}),o(e))return r.fromJSON(e);throw new Error("`Block.create` only accepts objects, strings or blocks, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e)||Array.isArray(e))return new t.List(e.map(r.create));throw new Error("`Block.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(r.isBlock(e))return e;var n=e.data,o=void 0===n?{}:n,a=e.key,i=void 0===a?u.create():a,s=e.nodes,c=void 0===s?[]:s,l=e.type;if("string"!=typeof l)throw new Error("`Block.fromJSON` requires a `type` string.");return new r({key:i,type:l,data:t.Map(o),nodes:D.createList(c)})}},{key:"isBlockList",value:function(e){return t.List.isList(e)&&e.every(function(e){return r.isBlock(e)})}}]),r}(t.Record(R)),J="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function K(){throw new Error("setTimeout has not been defined")}function U(){throw new Error("clearTimeout has not been defined")}var V=K,W=U;function q(e){if(V===setTimeout)return setTimeout(e,0);if((V===K||!V)&&setTimeout)return V=setTimeout,setTimeout(e,0);try{return V(e,0)}catch(t){try{return V.call(null,e,0)}catch(t){return V.call(this,e,0)}}}"function"==typeof J.setTimeout&&(V=setTimeout),"function"==typeof J.clearTimeout&&(W=clearTimeout);var $,H=[],G=!1,Y=-1;function Z(){G&&$&&(G=!1,$.length?H=$.concat(H):Y=-1,H.length&&X())}function X(){if(!G){var e=q(Z);G=!0;for(var t=H.length;t;){for($=H,H=[];++Y<t;)$&&$[Y].run();Y=-1,t=H.length}$=null,G=!1,function(e){if(W===clearTimeout)return clearTimeout(e);if((W===U||!W)&&clearTimeout)return W=clearTimeout,clearTimeout(e);try{W(e)}catch(t){try{return W.call(null,e)}catch(t){return W.call(this,e)}}}(e)}}function Q(e,t){this.fun=e,this.array=t}Q.prototype.run=function(){this.fun.apply(null,this.array)};function ee(){}var te=ee,re=ee,ne=ee,oe=ee,ae=ee,ie=ee,se=ee;var ue=J.performance||{},ce=ue.now||ue.mozNow||ue.msNow||ue.oNow||ue.webkitNow||function(){return(new Date).getTime()};var le=new Date;var fe={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];H.push(new Q(e,t)),1!==H.length||G||q(X)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:te,addListener:re,once:ne,off:oe,removeListener:ae,removeAllListeners:ie,emit:se,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*ce.call(ue),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-le)/1e3}},ve="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function de(e,t){return e(t={exports:{}},t.exports),t.exports}var he=1e3,ye=60*he,pe=60*ye,ke=24*pe,me=365.25*ke,ge=function(e,t){t=t||{};var r,n=typeof e;if("string"===n&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*me;case"days":case"day":case"d":return r*ke;case"hours":case"hour":case"hrs":case"hr":case"h":return r*pe;case"minutes":case"minute":case"mins":case"min":case"m":return r*ye;case"seconds":case"second":case"secs":case"sec":case"s":return r*he;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}(e);if("number"===n&&!1===isNaN(e))return t.long?be(r=e,ke,"day")||be(r,pe,"hour")||be(r,ye,"minute")||be(r,he,"second")||r+" ms":function(e){if(e>=ke)return Math.round(e/ke)+"d";if(e>=pe)return Math.round(e/pe)+"h";if(e>=ye)return Math.round(e/ye)+"m";if(e>=he)return Math.round(e/he)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function be(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}var Ae=de(function(e,t){function r(e){var r;function o(){if(o.enabled){var e=o,n=+new Date,a=n-(r||n);e.diff=a,e.prev=r,e.curr=n,r=n;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var u=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;u++;var o=t.formatters[n];if("function"==typeof o){var a=i[u];r=o.call(e,a),i.splice(u,1),u--}return r}),t.formatArgs.call(e,i),(o.log||t.log||console.log.bind(console)).apply(e,i)}}return o.namespace=e,o.enabled=t.enabled(e),o.useColors=t.useColors(),o.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),o.destroy=n,"function"==typeof t.init&&t.init(o),t.instances.push(o),o}function n(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var a=t.instances[r];a.enabled=t.enabled(a.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=ge,t.instances=[],t.names=[],t.skips=[],t.formatters={}}),xe=(Ae.coerce,Ae.disable,Ae.enable,Ae.enabled,Ae.humanize,Ae.instances,Ae.names,Ae.skips,Ae.formatters,de(function(e,t){function r(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==fe&&"env"in fe&&(e=fe.env.DEBUG),e}(t=e.exports=Ae).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,a=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(a=++o)}),e.splice(a,0,n)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=r,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(r())})),Oe=(xe.log,xe.formatArgs,xe.save,xe.load,xe.useColors,xe.storage,xe.colors,{});["deleteBackward","deleteCharBackward","deleteLineBackward","deleteWordBackward","deleteForward","deleteCharForward","deleteWordForward","deleteLineForward","setBlocks","setInlines","splitInline","unwrapBlock","unwrapInline","wrapBlock","wrapInline"].forEach(function(e){Oe[e]=function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=t.value.selection;t[e+"AtRange"].apply(t,[a].concat(n)),e.match(/Backward$/)?t.moveToStart():e.match(/Forward$/)&&t.moveToEnd()}}),Oe.addMark=function(e,t){t=N.create(t);var r=e.value,n=r.document,o=r.selection;if(o.isExpanded)e.addMarkAtRange(o,t);else if(o.marks){var a=o.marks.add(t),i=o.set("marks",a);e.select(i)}else{var s=n.getActiveMarksAtRange(o).add(t),u=o.set("marks",s);e.select(u)}},Oe.addMarks=function(e,t){t.forEach(function(t){return e.addMark(t)})},Oe.delete=function(e){var t=e.value.selection;e.deleteAtRange(t),e.moveToStart()},Oe.insertBlock=function(e,t){t=I.create(t);var r=e.value.selection;e.insertBlockAtRange(r,t);var n=e.value.document.getNode(t.key);n&&e.moveToEndOfNode(n)},Oe.insertFragment=function(e,t){if(t.nodes.size){var r=e.value,n=r,o=n.document,a=n.selection,i=a.start,s=a.end,u=r,c=u.startText,l=u.endText,f=u.startInline,v=t.getLastText(),d=t.getClosestInline(v.key),h=t.nodes.first(),y=t.nodes.last(),p=o.getTexts().map(function(e){return e.key}),k=!f||i.isAtStartOfNode(c)||s.isAtStartOfNode(c)||i.isAtEndOfNode(l)||s.isAtEndOfNode(l),m=h.hasBlockChildren()||y.hasBlockChildren();e.insertFragmentAtRange(a,t);var g=(o=(r=e.value).document).getTexts().filter(function(e){return!p.includes(e.key)}),b=k?g.last():g.takeLast(2).first();b&&(d||m)?e.select(a.moveToEndOfNode(b)):b?e.select(a.moveToStartOfNode(b).moveForward(v.text.length)):e.select(a.moveToStart().moveForward(v.text.length))}},Oe.insertInline=function(e,t){t=O.create(t);var r=e.value.selection;e.insertInlineAtRange(r,t);var n=e.value.document.getNode(t.key);n&&e.moveToEndOfNode(n)},Oe.insertText=function(e,t,r){var n=e.value,o=n.document,a=n.selection;r=r||a.marks||o.getInsertMarksAtRange(a),e.insertTextAtRange(a,t,r),a.marks&&o!=e.value.document&&e.select({marks:null})},Oe.removeMark=function(e,t){t=N.create(t);var r=e.value,n=r.document,o=r.selection;if(o.isExpanded)e.removeMarkAtRange(o,t);else if(o.marks){var a=o.marks.remove(t),i=o.set("marks",a);e.select(i)}else{var s=n.getActiveMarksAtRange(o).remove(t),u=o.set("marks",s);e.select(u)}},Oe.replaceMark=function(e,t,r){e.removeMark(t),e.addMark(r)},Oe.splitBlock=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.value,n=r.selection,o=r.document,a=n.marks||o.getInsertMarksAtRange(n);e.splitBlockAtRange(n,t).moveToEnd(),a&&0!==a.size&&e.select({marks:a})},Oe.toggleMark=function(e,t){t=N.create(t),e.value.activeMarks.has(t)?e.removeMark(t):e.addMark(t)},Oe.wrapText=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,n=e.value.selection;e.wrapTextAtRange(n,t,r),n.isCollapsed&&e.moveStartBackward(t.length),e.moveEndBackward(r.length),n.isForward!=e.value.selection.isForward&&e.flip()};var Te=de(function(e,t){!function(r){var n=t,o=e&&e.exports==n&&e,a="object"==typeof ve&&ve;a.global!==a&&a.window!==a||(r=a);var i=/([\0-\u02FF\u0370-\u1AAF\u1B00-\u1DBF\u1E00-\u20CF\u2100-\uD7FF\uE000-\uFE1F\uFE30-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])([\u0300-\u036F\u1AB0-\u1AFF\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F]+)/g,s=/([\uD800-\uDBFF])([\uDC00-\uDFFF])/g,u=function(e){for(var t="",r=(e=e.replace(i,function(e,t,r){return u(r)+t}).replace(s,"$2$1")).length;r--;)t+=e.charAt(r);return t},c={version:"0.2.0",reverse:u};if(n&&!n.nodeType)if(o)o.exports=c;else for(var l in c)c.hasOwnProperty(l)&&(n[l]=c[l]);else r.esrever=c}(ve)}).reverse,Ne=55296,we=57343,_e=/\s/,Se=/['\u2018\u2019]/,Fe=/[\u0021-\u0023\u0025-\u002A\u002C-\u002F\u003A\u003B\u003F\u0040\u005B-\u005D\u005F\u007B\u007D\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/;function Ee(e){return Ne<=e&&e<=we}function Be(e,t){if(_e.test(e))return!1;if(Se.test(e)){var r=t.charAt(0),n=je(r);if(Be(r=t.slice(0,n),t.slice(n)))return!0}return!Fe.test(e)}function je(e){return Ee(e.charCodeAt(0))?2:1}function Pe(e){return je(e.charAt(0))}function Ce(e){for(var t=0,r=0,n=!1,o=void 0;o=e.charAt(r);){var a=je(o);if(Be(o=e.slice(r,r+a),e.slice(r+a)))n=!0,t+=a;else{if(n)break;t+=a}r+=a}return t}var Le={getCharLength:je,getCharOffset:Pe,getCharOffsetBackward:function(e,t){return e=e.slice(0,t),Pe(e=Te(e))},getCharOffsetForward:function(e,t){return Pe(e=e.slice(t))},getWordOffset:Ce,getWordOffsetBackward:function(e,t){return e=e.slice(0,t),Ce(e=Te(e))},getWordOffsetForward:function(e,t){return Ce(e=e.slice(t))},isSurrogate:Ee,isWord:Be},ze={};function Me(e,t){if(e.size!==t.size)return null;for(var r=0;r<e.size;r++){var n=e.get(r),o=t.get(r);if(n<o)return-1;if(n>o)return 1}return 0}function De(e){if(null==e)return null;if(t.List.isList(e))return e;if(Array.isArray(e))return t.List(e);throw new Error("Paths can only be created from arrays or lists, but you passed: "+e)}function Re(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:We(e,t);return[e.slice(0,r),t.slice(0,r)]}function Ie(e){return Je(e,0-(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.size-1)}function Je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.size-1,n=e.get(r)+t;return e.set(r,n)}function Ke(e,t){var r=Re(e,t),n=k(r,2),o=n[0],a=n[1];return e.size<t.size&&0===Me(o,a)}function Ue(e,t){return e.equals(t)}function Ve(e,t){var r=e.size-1,n=Re(e,t,r),o=k(n,2),a=o[0],i=o[1],s=e.get(r),u=t.get(r);return Ue(a,i)&&s<u}function We(e,t){return Math.min(e.size,t.size)}ze.addMarkAtRange=function(e,t,r){if(!t.isCollapsed){var n=e.value.document,o=t.start,a=t.end,i=n.getTextsAtRange(t);e.withoutNormalizing(function(){i.forEach(function(t){var n=t.key,i=0,s=t.text.length;n==o.key&&(i=o.offset),n==a.key&&(s=a.offset),n==o.key&&n==a.key&&(s=a.offset-o.offset),e.addMarkByKey(n,i,s,r)})})}},ze.addMarksAtRange=function(e,t,r){r.forEach(function(r){return e.addMarkAtRange(t,r)})},ze.deleteAtRange=function(e,t){e.snapshotSelection();var r=e.value,n=t.start,o=t.end,a=n.key,i=n.offset,s=o.key,u=o.offset,c=r.document,l=r.schema,f=c.hasVoidParent(a,l),v=c.hasVoidParent(s,l),d=c.getClosestBlock(a,l),h=c.getClosestBlock(s,l),y=0==i&&0==u&&0==f&&a==d.getFirstText().key&&s==h.getFirstText().key;if(y&&v){var p=c.getPreviousText(s);s=p.key,u=p.text.length,v=c.hasVoidParent(s,l)}e.withoutNormalizing(function(){for(;f;){var t=c.getClosestVoid(a,l),r=c.getNextText(a);if(e.removeNodeByKey(t.key),a==s)return;if(!r)return;c=e.value.document,a=r.key,i=0,f=c.hasVoidParent(a,l)}for(;v;){var n=c.getClosestVoid(s,l),o=c.getPreviousText(s);e.removeNodeByKey(n.key),c=e.value.document,s=o.key,u=o.text.length,v=c.hasVoidParent(s,l)}if(a==s&&y)e.removeNodeByKey(d.key);else if(a!=s){d=c.getClosestBlock(a),h=c.getClosestBlock(s);var p=c.getNode(a),k=c.getNode(s),m=p.text.length-i,g=u,b=c.getCommonAncestor(a,s),A=b.getFurthestAncestor(a),x=b.getFurthestAncestor(s),O=c.getParent(d.key),T=O.nodes.indexOf(d),N=O.nodes.indexOf(h),w=void 0;for(w=p;w.key!=A.key;){var _=c.getParent(w.key),S=_.nodes.indexOf(w);_.nodes.slice(S+1).reverse().forEach(function(t){e.removeNodeByKey(t.key)}),w=_}var F=b.nodes.indexOf(A),E=b.nodes.indexOf(x);for(b.nodes.slice(F+1,E).reverse().forEach(function(t){e.removeNodeByKey(t.key)}),w=k;w.key!=x.key;){var B=c.getParent(w.key),j=B.nodes.indexOf(w);B.nodes.slice(0,j).reverse().forEach(function(t){e.removeNodeByKey(t.key)}),w=B}if(0!=m&&e.removeTextByKey(a,i,m),0!=g&&e.removeTextByKey(s,0,u),d.key!=h.key){var P=(c=e.value.document).getFurthestOnlyChildAncestor(h.key);N!=T+1&&e.moveNodeByKey(h.key,O.key,T+1),y?e.removeNodeByKey(d.key):e.mergeNodeByKey(h.key),P&&e.removeNodeByKey(P.key)}}else{var C=i,L=u-i;e.removeTextByKey(a,C,L)}})},ze.deleteCharBackwardAtRange=function(e,t){var r=e.value.document,n=t.start,o=r.getClosestBlock(n.key),a=o.getOffset(n.key)+n.offset,i=o.text,s=Le.getCharOffsetBackward(i,a);e.deleteBackwardAtRange(t,s)},ze.deleteLineBackwardAtRange=function(e,t){var r=e.value.document,n=t.start,o=r.getClosestBlock(n.key).getOffset(n.key)+n.offset;e.deleteBackwardAtRange(t,o)},ze.deleteWordBackwardAtRange=function(e,t){var r=e.value.document,n=t.start,o=r.getClosestBlock(n.key),a=o.getOffset(n.key)+n.offset,i=o.text,s=0===a?1:Le.getWordOffsetBackward(i,a);e.deleteBackwardAtRange(t,s)},ze.deleteBackwardAtRange=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0!==r){var n=e.value,o=n.document,a=n.schema,i=t,s=i.start,u=i.focus;if(t.isExpanded)e.deleteAtRange(t);else{var c=o.getClosestVoid(s.key,a);if(c)e.removeNodeByKey(c.key);else{var l=o.getClosestBlock(s.key);if(!l||a.isVoid(l)||""!==l.text||1===o.nodes.size){if(!s.isAtStartOfNode(o)){var f=o.getDescendant(s.key);if(s.isAtStartOfNode(f)){var v=o.getPreviousText(f.key),d=o.getClosestBlock(v.key),h=o.getClosestVoid(v.key,a);if(h)return void e.removeNodeByKey(h.key);if(1==r&&d!=l)return t=t.moveAnchorTo(v.key,v.text.length),void e.deleteAtRange(t)}if(r<u.offset)return t=t.moveFocusBackward(r),void e.deleteAtRange(t);for(var y=f,p=0,k=u.offset;r>k;){var m=k+(y=o.getPreviousText(y.key)).text.length;if(r<=m){p=m-r;break}k=m}t=t.moveAnchorTo(y.key,p),e.deleteAtRange(t)}}else e.removeNodeByKey(l.key)}}}},ze.deleteCharForwardAtRange=function(e,t){var r=e.value.document,n=t.start,o=r.getClosestBlock(n.key),a=o.getOffset(n.key)+n.offset,i=o.text,s=Le.getCharOffsetForward(i,a);e.deleteForwardAtRange(t,s)},ze.deleteLineForwardAtRange=function(e,t){var r=e.value.document,n=t.start,o=r.getClosestBlock(n.key),a=o.getOffset(n.key)+n.offset;e.deleteForwardAtRange(t,o.text.length-a)},ze.deleteWordForwardAtRange=function(e,t){var r=e.value.document,n=t.start,o=r.getClosestBlock(n.key),a=o.getOffset(n.key)+n.offset,i=o.text,s=Le.getWordOffsetForward(i,a);e.deleteForwardAtRange(t,s)},ze.deleteForwardAtRange=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0!==r){var n=e.value,o=n.document,a=n.schema,i=t,s=i.start,u=i.focus;if(t.isExpanded)e.deleteAtRange(t);else{var c=o.getClosestVoid(s.key,a);if(c)e.removeNodeByKey(c.key);else{var l=o.getClosestBlock(s.key);if(l&&!a.isVoid(l)&&""===l.text&&1!==o.nodes.size){var f=o.getNextBlock(l.key);return e.removeNodeByKey(l.key),void(f&&f.key&&e.moveToStartOfNode(f))}if(!s.isAtEndOfNode(o)){var v=o.getDescendant(s.key);if(s.isAtEndOfNode(v)){var d=o.getNextText(v.key),h=o.getClosestBlock(d.key),y=o.getClosestVoid(d.key,a);if(y)return void e.removeNodeByKey(y.key);if(1==r&&h!=l)return t=t.moveFocusTo(d.key,0),void e.deleteAtRange(t)}if(r<=v.text.length-u.offset)return t=t.moveFocusForward(r),void e.deleteAtRange(t);for(var p=v,k=u.offset,m=v.text.length-u.offset;r>m;){var g=m+(p=o.getNextText(p.key)).text.length;if(r<=g){k=r-m;break}m=g}t=t.moveFocusTo(p.key,k),e.deleteAtRange(t)}}}}},ze.insertBlockAtRange=function(e,t,r){r=I.create(r),t.isExpanded&&(e.deleteAtRange(t),t=t.moveToStart());var n=e.value,o=n.document,a=n.schema,i=t.start,s=i.key,u=i.offset,c=o.getClosestBlock(s),l=o.getClosestInline(s),f=o.getParent(c.key),v=f.nodes.indexOf(c);if(a.isVoid(c)){var d=i.isAtEndOfNode(c)?1:0;e.insertNodeByKey(f.key,v+d,r)}else if(l||""!==c.text)if(i.isAtStartOfNode(c))e.insertNodeByKey(f.key,v,r);else if(i.isAtEndOfNode(c))e.insertNodeByKey(f.key,v+1,r);else{if(l&&a.isVoid(l)){var h=i.isAtEndOfNode(l),y=h?o.getNextText(s):o.getPreviousText(s),p=h?t.moveToStartOfNode(y):t.moveToEndOfNode(y);s=p.start.key,u=p.start.offset}e.withoutNormalizing(function(){e.splitDescendantsByKey(c.key,s,u),e.insertNodeByKey(f.key,v+1,r)})}else e.insertNodeByKey(f.key,v+1,r)},ze.insertFragmentAtRange=function(e,r,n){e.withoutNormalizing(function(){if(r.isExpanded&&(e.deleteAtRange(r),r=e.value.document.getDescendant(r.start.key)?r.moveToStart():r.moveTo(r.end.key,0).normalize(e.value.document)),n.nodes.size){n=n.mapDescendants(function(e){return e.regenerateKey()});var o=r.start,a=e.value,i=a.schema,s=a.document,u=s.getDescendant(o.key),c=s.getClosestBlock(u.key),l=c.getFurthestAncestor(u.key),f=o.isAtStartOfNode(c),v=s.getParent(c.key),d=v.nodes.indexOf(c),h=n.getBlocks(),y=n.nodes.first(),p=n.nodes.last(),k=h.first(),m=h.last();if(k===m&&i.isVoid(k))e.insertBlockAtRange(r,k);else if(y.hasBlockChildren()||p.hasBlockChildren())n.nodes.reverse().forEach(function(t){e.insertBlockAtRange(r,t)});else{if(k!=m){var g=n.getFurthest(k.key,function(e){return 1==e.nodes.size})||k,b=v.nodes.indexOf(c);(n=n.removeNode(g.key)).nodes.forEach(function(t,r){var n=b+r+1;e.insertNodeByKey(v.key,n,t)})}if(0!=o.offset&&e.splitDescendantsByKey(l.key,o.key,o.offset),u=(s=e.value.document).getDescendant(o.key),l=(c=s.getClosestBlock(o.key)).getFurthestAncestor(u.key),k!=m){var A=f?l:c.getNextSibling(l.key),x=A?c.nodes.skipUntil(function(e){return e.key==A.key}):t.List(),O=m.nodes.size;x.forEach(function(t,r){var n=O+r;e.moveNodeByKey(t.key,m.key,n)})}if(i.isVoid(c)||""!==c.text){var T=c.getFurthestAncestor(u.key),N=c.nodes.indexOf(T);k.nodes.forEach(function(t,r){var n=0==o.offset?0:1,a=N+r+n;e.insertNodeByKey(c.key,a,t)})}else e.removeNodeByKey(c.key),e.insertNodeByKey(v.key,d,k)}}})},ze.insertInlineAtRange=function(e,t,r){r=O.create(r),e.withoutNormalizing(function(){t.isExpanded&&(e.deleteAtRange(t),t=t.moveToStart());var n=e.value,o=n.document,a=n.schema,i=t.start,s=o.getParent(i.key),u=o.assertDescendant(i.key),c=s.nodes.indexOf(u);a.isVoid(s)||(e.splitNodeByKey(i.key,i.offset),e.insertNodeByKey(s.key,c+1,r))})},ze.insertTextAtRange=function(e,t,r,n){var o=e.value,a=o.document,i=o.schema,s=t.start,u=s.key,c=s.offset,l=a.getParent(s.key);i.isVoid(l)||e.withoutNormalizing(function(){t.isExpanded&&(e.deleteAtRange(t),e.value.selection.start.key!==u&&(u=e.value.selection.start.key,c=e.value.selection.start.offset)),e.insertTextByKey(u,c,r,n)})},ze.removeMarkAtRange=function(e,t,r){if(!t.isCollapsed){var n=e.value.document.getTextsAtRange(t),o=t.start,a=t.end;e.withoutNormalizing(function(){n.forEach(function(t){var n=t.key,i=0,s=t.text.length;n==o.key&&(i=o.offset),n==a.key&&(s=a.offset),n==o.key&&n==a.key&&(s=a.offset-o.offset),e.removeMarkByKey(n,i,s,r)})})}},ze.setBlocksAtRange=function(e,t,r){var n=e.value,o=n.document,a=n.schema,i=o.getBlocksAtRange(t),s=t.start,u=t.end,c=t.isCollapsed,l=o.hasVoidParent(s.key,a),f=o.getClosestBlock(s.key),v=o.getClosestBlock(u.key),d=0==c&&0==s.offset&&0==u.offset&&0==l&&s.key==f.getFirstText().key&&u.key==v.getFirstText().key?i.slice(0,-1):i;e.withoutNormalizing(function(){d.forEach(function(t){e.setNodeByKey(t.key,r)})})},ze.setInlinesAtRange=function(e,t,r){var n=e.value.document.getInlinesAtRange(t);e.withoutNormalizing(function(){n.forEach(function(t){e.setNodeByKey(t.key,r)})})},ze.splitBlockAtRange=function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=t,o=n.start,a=n.end,i=e.value,s=i.document,u=s.assertDescendant(o.key),c=s.getClosestBlock(u.key),l=0;c&&"block"==c.object&&l<r;)u=c,c=s.getClosestBlock(c.key),l++;e.withoutNormalizing(function(){if(e.splitDescendantsByKey(u.key,o.key,o.offset),i=e.value,s=i.document,t.isExpanded){t.isBackward&&(t=t.flip());var r=s.getNextBlock(u.key);t=(t=t.moveAnchorToStartOfNode(r)).setFocus(t.focus.setPath(null)),o.key===a.key&&(t=t.moveFocusTo(t.anchor.key,a.offset-o.offset)),t=s.resolveRange(t),e.deleteAtRange(t)}})},ze.splitInlineAtRange=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;t.isExpanded&&(e.deleteAtRange(t),t=t.moveToStart());for(var n=t.start,o=e.value.document,a=o.assertDescendant(n.key),i=o.getClosestInline(a.key),s=0;i&&"inline"==i.object&&s<r;)a=i,i=o.getClosestInline(i.key),s++;e.splitDescendantsByKey(a.key,n.key,n.offset)},ze.toggleMarkAtRange=function(e,t,r){t.isCollapsed||(r=N.create(r),e.value.document.getActiveMarksAtRange(t).some(function(e){return e.equals(r)})?e.removeMarkAtRange(t,r):e.addMarkAtRange(t,r))},ze.unwrapBlockAtRange=function(e,t,r){r=D.createProperties(r);var n=e.value.document,o=n.getBlocksAtRange(t),a=o.map(function(e){return n.getClosest(e.key,function(e){return"block"==e.object&&((null==r.type||e.type==r.type)&&!(null!=r.data&&!e.data.isSuperset(r.data)))})}).filter(function(e){return e}).toOrderedSet().toList();e.withoutNormalizing(function(){a.forEach(function(t){var r=t.nodes.first(),a=t.nodes.last(),i=n.getParent(t.key),s=i.nodes.indexOf(t),u=t.nodes.filter(function(e){return o.some(function(t){return e==t||e.hasDescendant(t.key)})}),c=u.first(),l=u.last();if(r==c&&a==l)t.nodes.forEach(function(t,r){e.moveNodeByKey(t.key,i.key,s+r)}),e.removeNodeByKey(t.key);else if(a==l)t.nodes.skipUntil(function(e){return e==c}).forEach(function(t,r){e.moveNodeByKey(t.key,i.key,s+1+r)});else if(r==c)t.nodes.takeUntil(function(e){return e==l}).push(l).forEach(function(t,r){e.moveNodeByKey(t.key,i.key,s+r)});else{var f=c.getFirstText();e.splitDescendantsByKey(t.key,f.key,0),n=e.value.document,u.forEach(function(t,r){if(0==r){var o=t;t=n.getNextBlock(t.key),e.removeNodeByKey(o.key)}e.moveNodeByKey(t.key,i.key,s+1+r)})}})})},ze.unwrapInlineAtRange=function(e,t,r){r=D.createProperties(r);var n=e.value.document,o=n.getTextsAtRange(t).map(function(e){return n.getClosest(e.key,function(e){return"inline"==e.object&&((null==r.type||e.type==r.type)&&!(null!=r.data&&!e.data.isSuperset(r.data)))})}).filter(function(e){return e}).toOrderedSet().toList();e.withoutNormalizing(function(){o.forEach(function(t){var r=e.value.document.getParent(t.key),n=r.nodes.indexOf(t);t.nodes.forEach(function(t,o){e.moveNodeByKey(t.key,r.key,n+o)}),e.removeNodeByKey(t.key)})})},ze.wrapBlockAtRange=function(e,t,r){r=(r=I.create(r)).set("nodes",r.nodes.clear());var n=e.value.document,o=n.getBlocksAtRange(t),a=o.first(),i=o.last(),s=void 0,u=void 0,c=void 0;if(1===o.length?(s=n.getParent(a.key),u=o):s=n.getClosest(a.key,function(e){return!!n.getClosest(i.key,function(t){return e==t})}),null==s&&(s=n),null==u){var l=s.nodes.reduce(function(e,t,r){return(t==a||t.hasDescendant(a.key))&&(e[0]=r),(t==i||t.hasDescendant(i.key))&&(e[1]=r),e},[]);c=l[0],u=s.nodes.slice(l[0],l[1]+1)}null==c&&(c=s.nodes.indexOf(u.first())),e.withoutNormalizing(function(){e.insertNodeByKey(s.key,c,r),u.forEach(function(t,n){e.moveNodeByKey(t.key,r.key,n)})})},ze.wrapInlineAtRange=function(e,r,n){var o=e.value,a=o.document,i=o.schema,s=r.start,u=r.end;if(r.isCollapsed){var c=a.getClosestInline(s.key);if(!i.isVoid(c))return;return e.wrapInlineByKey(c.key,n)}n=(n=O.create(n)).set("nodes",n.nodes.clear());var l=a.getBlocksAtRange(r),f=a.getClosestBlock(s.key),v=a.getClosestBlock(u.key),d=a.getClosestInline(s.key),h=a.getClosestInline(u.key),y=f.getFurthestAncestor(s.key),p=v.getFurthestAncestor(u.key);e.withoutNormalizing(function(){d&&d==h||(e.splitDescendantsByKey(p.key,u.key,u.offset),e.splitDescendantsByKey(y.key,s.key,s.offset)),a=e.value.document,f=a.getDescendant(f.key),v=a.getDescendant(v.key),y=f.getFurthestAncestor(s.key),p=v.getFurthestAncestor(u.key);var o=f.nodes.indexOf(y),i=v.nodes.indexOf(p);if(d&&d==h){var c=f.getTextsAtRange(r).get(0).splitText(s.offset)[1].splitText(u.offset-s.offset)[0];n=n.set("nodes",t.List([c])),e.insertInlineAtRange(r,n);var k=n.getFirstText().key,m={anchor:{key:k,offset:0},focus:{key:k,offset:u.offset-s.offset},isFocused:!0};e.select(m)}else if(f==v){a=e.value.document,f=a.getClosestBlock(s.key),y=f.getFurthestAncestor(s.key);var g=a.getNextSibling(y.key),b=f.nodes.indexOf(g),A=s.key==u.key?g:f.getFurthestAncestor(u.key),x=f.nodes.skipUntil(function(e){return e==g}).takeUntil(function(e){return e==A}).push(A),O=n.regenerateKey();e.insertNodeByKey(f.key,b,O),x.forEach(function(t,r){e.moveNodeByKey(t.key,O.key,r)})}else{var T=f.nodes.slice(o+1),N=v.nodes.slice(0,i+1),w=n.regenerateKey(),_=n.regenerateKey();e.insertNodeByKey(f.key,o+1,w),e.insertNodeByKey(v.key,i,_),T.forEach(function(t,r){e.moveNodeByKey(t.key,w.key,r)}),N.forEach(function(t,r){e.moveNodeByKey(t.key,_.key,r)}),l.slice(1,-1).forEach(function(t){var r=n.regenerateKey();e.insertNodeByKey(t.key,0,r),t.nodes.forEach(function(t,n){e.moveNodeByKey(t.key,r.key,n)})})}})},ze.wrapTextAtRange=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,o=t.start,a=t.end,i=t.moveToStart(),s=t.moveToEnd();o.key==a.key&&(s=s.moveForward(r.length)),e.withoutNormalizing(function(){e.insertTextAtRange(i,r,[]),e.insertTextAtRange(s,n,[])})};var qe={compare:Me,create:De,crop:Re,decrement:Ie,increment:Je,isAbove:Ke,isAfter:function(e,t){var r=Re(e,t),n=k(r,2);return 1===Me(n[0],n[1])},isBefore:function(e,t){var r=Re(e,t),n=k(r,2);return-1===Me(n[0],n[1])},isEqual:Ue,isOlder:function(e,t){var r=e.size-1,n=Re(e,t,r),o=k(n,2),a=o[0],i=o[1],s=e.get(r),u=t.get(r);return Ue(a,i)&&s>u},isSibling:function(e,t){if(e.size!==t.size)return!1;var r=e.butLast(),n=t.butLast();return r.equals(n)},isYounger:Ve,lift:function(e){return e.slice(0,-1)},max:function(e,t){return Math.max(e.size,t.size)},min:We,relate:function(e,t){for(var r=[],n=0;n<e.size&&n<t.size;n++){var o=e.get(n);if(o!==t.get(n))break;r.push(o)}return De(r)},transform:function(e,r){var n=r.type,o=r.position,a=r.path;if("add_mark"===n||"insert_text"===n||"remove_mark"===n||"remove_text"===n||"set_mark"===n||"set_node"===n||"set_selection"===n||"set_value"===n||0===e.size)return t.List([e]);var i=a.size-1,s=Ue(a,e),u=Ve(a,e),c=Ke(a,e);if("insert_node"===n&&(s||u||c)&&(e=Je(e,1,i)),"remove_node"===n&&(u?e=Ie(e,1,i):(s||c)&&(e=[])),"merge_node"===n&&(s||u?e=Ie(e,1,i):c&&(e=Je(e=Ie(e,1,i),o,i+1))),"split_node"===n&&(s?e=[e,Je(e)]:u?e=Je(e,1,i):c&&e.get(i+1)>=o&&(e=Ie(e=Je(e,1,i),o,i+1))),"move_node"===n){var l=r.newPath,f=l.size-1,v=Ue(l,e),d=Ve(l,e),h=Ke(l,e);c?e=l.concat(e.slice(a.size)):(s?e=l:u&&(e=Ie(e,1,i)),(v||d||h)&&(e=Je(e,1,f)))}var y=Array.isArray(e)?e:[e];return t.List(y)}},$e={addMarkByPath:function(e,t,r,n,o){o=N.create(o);var a=e.value,i=[],s=r,u=r+n,c=0;a.document.assertNode(t).getLeaves().forEach(function(e){var r=c,n=r+e.text.length;if(c+=e.text.length,!(n<s||u<r||e.marks.has(o))){var l=Math.max(r,s),f=Math.min(n,u);i.push({type:"add_mark",value:a,path:t,offset:l,length:f-l,mark:o})}}),e.applyOperations(i)},insertFragmentByPath:function(e,t,r,n){n.nodes.forEach(function(n,o){e.insertNodeByPath(t,r+o,n)})},insertNodeByPath:function(e,t,r,n){var o=e.value;e.applyOperation({type:"insert_node",value:o,path:t.concat(r),node:n})},insertTextByPath:function(e,t,r,n,o){var a=e.value,i=a.document.assertNode(t);o=o||i.getMarksAtIndex(r),e.applyOperation({type:"insert_text",value:a,path:t,offset:r,text:n,marks:o})},mergeNodeByPath:function(e,t){var r=e.value,n=r.document,o=n.getDescendant(t),a=n.getPreviousSibling(t);if(!a)throw new Error('Unable to merge node with path "'+t+'", because it has no previous sibling.');var i="text"==a.object?a.text.length:a.nodes.size;e.applyOperation({type:"merge_node",value:r,path:t,position:i,properties:{type:o.type,data:o.data},target:null})},moveNodeByPath:function(e,t,r,n){var o=e.value;e.applyOperation({type:"move_node",value:o,path:t,newPath:r.concat(n)})},removeMarkByPath:function(e,t,r,n,o){o=N.create(o);var a=e.value,i=[],s=r,u=r+n,c=0;a.document.assertNode(t).getLeaves().forEach(function(e){var r=c,n=r+e.text.length;if(c+=e.text.length,!(n<s||u<r)&&e.marks.has(o)){var l=Math.max(r,s),f=Math.min(n,u);i.push({type:"remove_mark",value:a,path:t,offset:l,length:f-l,mark:o})}}),e.applyOperations(i)},removeAllMarksByPath:function(e,t){var r=e.state.document.assertNode(t);("text"===r.object?[r]:r.getTextsAsArray()).forEach(function(t){t.getMarksAsArray().forEach(function(r){e.removeMarkByKey(t.key,0,t.text.length,r)})})},removeNodeByPath:function(e,t){var r=e.value,n=r.document.assertNode(t);e.applyOperation({type:"remove_node",value:r,path:t,node:n})},removeTextByPath:function(e,t,r,n){var o=e.value,a=o.document.assertNode(t),i=a.getLeaves(),s=a.text,u=[],c=r,l=r+n,f=0;i.forEach(function(e){var r=f,n=r+e.text.length;if(f+=e.text.length,!(n<c||l<r)){var a=Math.max(r,c),i=Math.min(n,l),v=s.slice(a,i);u.push({type:"remove_text",value:o,path:t,offset:a,text:v,marks:e.marks})}}),e.applyOperations(u.reverse())},replaceNodeByPath:function(e,t,r){r=D.create(r);var n=t.last(),o=qe.lift(t);e.withoutNormalizing(function(){e.removeNodeByPath(t),e.insertNodeByPath(o,n,r)})},replaceTextByPath:function(e,t,r,n,o,a){var i=e.value.document,s=i.assertNode(t);n+r>s.text.length&&(n=s.text.length-r);var u=i.createRange({anchor:{path:t,offset:r},focus:{path:t,offset:r+n}}),c=i.getActiveMarksAtRange(u);e.withoutNormalizing(function(){e.removeTextByPath(t,r,n),a?c&&(c=c.filter(function(e){return!a.find(function(t){return e.type===t.type})}),a=c.merge(a)):a=c||[],e.insertTextByPath(t,r,o,a)})},setMarkByPath:function(e,t,r,n,o,a){o=N.create(o),a=N.createProperties(a);var i=e.value;e.applyOperation({type:"set_mark",value:i,path:t,offset:r,length:n,mark:o,properties:a})},setNodeByPath:function(e,t,r){r=D.createProperties(r);var n=e.value,o=n.document.assertNode(t);e.applyOperation({type:"set_node",value:n,path:t,node:o,properties:r})},setTextByPath:function(e,t,r,n){var o=e.value.document.assertNode(t).text.length;e.replaceTextByPath(t,0,o,r,n)},splitNodeByPath:function(e,t,r){var n=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).target,o=void 0===n?null:n,a=e.value,i=a.document.getDescendant(t);e.applyOperation({type:"split_node",value:a,path:t,position:r,target:o,properties:{type:i.type,data:i.data}})},splitDescendantsByPath:function(e,t,r,n){if(t.equals(r))e.splitNodeByPath(r,n);else{var o=e.value.document,a=o.assertNode(t),i=o.assertNode(r),s=o.getAncestors(r).skipUntil(function(e){return e.key==a.key}).reverse().unshift(i),u=void 0,c=void 0;e.withoutNormalizing(function(){s.forEach(function(t){var r=null==c?null:c;c=u?t.nodes.indexOf(u)+1:n,u=t,e.splitNodeByKey(t.key,c,{target:r})})})}},unwrapInlineByPath:function(e,t,r){var n=e.value,o=n.document,a=n.selection,i=o.assertNode(t),s=i.getFirstText(),u=i.getLastText(),c=a.moveToRangeOfNode(s,u);e.unwrapInlineAtRange(c,r)},unwrapBlockByPath:function(e,t,r){var n=e.value,o=n.document,a=n.selection,i=o.assertNode(t),s=i.getFirstText(),u=i.getLastText(),c=a.moveToRangeOfNode(s,u);e.unwrapBlockAtRange(c,r)},unwrapNodeByPath:function(e,t){var r=e.value.document;r.assertNode(t);var n=qe.lift(t),o=r.assertNode(n),a=t.last(),i=n.last(),s=qe.lift(n),u=0===a,c=a===o.nodes.size-1;e.withoutNormalizing(function(){if(1===o.nodes.size)e.moveNodeByPath(t,s,i+1),e.removeNodeByPath(n);else if(u)e.moveNodeByPath(t,s,i);else if(c)e.moveNodeByPath(t,s,i+1);else{var r=qe.increment(t,1,n.size-1);r=r.set(r.size-1,0),e.splitNodeByPath(n,a),e.moveNodeByPath(r,s,i+1)}})},wrapBlockByPath:function(e,t,r){r=(r=I.create(r)).set("nodes",r.nodes.clear());var n=qe.lift(t),o=t.last(),a=qe.increment(t);e.withoutNormalizing(function(){e.insertNodeByPath(n,o,r),e.moveNodeByPath(a,t,0)})},wrapInlineByPath:function(e,t,r){r=(r=O.create(r)).set("nodes",r.nodes.clear());var n=qe.lift(t),o=t.last(),a=qe.increment(t);e.withoutNormalizing(function(){e.insertNodeByPath(n,o,r),e.moveNodeByPath(a,t,0)})},wrapNodeByPath:function(e,t,r){"block"===(r=D.create(r)).object?e.wrapBlockByPath(t,r):"inline"===r.object&&e.wrapInlineByPath(t,r)}},He=function(e){$e[e+"ByKey"]=function(t,r){for(var n=arguments.length,o=Array(n>2?n-2:0),a=2;a<n;a++)o[a-2]=arguments[a];var i=t.value.document.assertPath(r);t[e+"ByPath"].apply(t,[i].concat(o))}},Ge=!0,Ye=!1,Ze=void 0;try{for(var Xe,Qe=["addMark","insertFragment","insertNode","insertText","mergeNode","removeMark","removeAllMarks","removeNode","setText","replaceText","removeText","replaceNode","setMark","setNode","splitNode","unwrapInline","unwrapBlock","unwrapNode","wrapBlock","wrapInline","wrapNode"][Symbol.iterator]();!(Ge=(Xe=Qe.next()).done);Ge=!0){He(Xe.value)}}catch(e){Ye=!0,Ze=e}finally{try{!Ge&&Qe.return&&Qe.return()}finally{if(Ye)throw Ze}}$e.moveNodeByKey=function(e,t,r){for(var n=arguments.length,o=Array(n>3?n-3:0),a=3;a<n;a++)o[a-3]=arguments[a];var i=e.value.document,s=i.assertPath(t),u=i.assertPath(r);e.moveNodeByPath.apply(e,[s,u].concat(o))},$e.splitDescendantsByKey=function(e,t,r){for(var n=arguments.length,o=Array(n>3?n-3:0),a=3;a<n;a++)o[a-3]=arguments[a];var i=e.value.document,s=i.assertPath(t),u=i.assertPath(r);e.splitDescendantsByPath.apply(e,[s,u].concat(o))};var et=function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o};var tt=function(){this.__data__=[],this.size=0};var rt=function(e,t){return e===t||e!=e&&t!=t};var nt=function(e,t){for(var r=e.length;r--;)if(rt(e[r][0],t))return r;return-1},ot=Array.prototype.splice;var at=function(e){var t=this.__data__,r=nt(t,e);return!(r<0||(r==t.length-1?t.pop():ot.call(t,r,1),--this.size,0))};var it=function(e){var t=this.__data__,r=nt(t,e);return r<0?void 0:t[r][1]};var st=function(e){return nt(this.__data__,e)>-1};var ut=function(e,t){var r=this.__data__,n=nt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function ct(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ct.prototype.clear=tt,ct.prototype.delete=at,ct.prototype.get=it,ct.prototype.has=st,ct.prototype.set=ut;var lt=ct;var ft=function(){this.__data__=new lt,this.size=0};var vt=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var dt=function(e){return this.__data__.get(e)};var ht=function(e){return this.__data__.has(e)},yt="object"==typeof ve&&ve&&ve.Object===Object&&ve,pt="object"==typeof self&&self&&self.Object===Object&&self,kt=yt||pt||Function("return this")(),mt=kt.Symbol,gt=Object.prototype,bt=gt.hasOwnProperty,At=gt.toString,xt=mt?mt.toStringTag:void 0;var Ot=function(e){var t=bt.call(e,xt),r=e[xt];try{e[xt]=void 0;var n=!0}catch(e){}var o=At.call(e);return n&&(t?e[xt]=r:delete e[xt]),o},Tt=Object.prototype.toString;var Nt=function(e){return Tt.call(e)},wt="[object Null]",_t="[object Undefined]",St=mt?mt.toStringTag:void 0;var Ft=function(e){return null==e?void 0===e?_t:wt:St&&St in Object(e)?Ot(e):Nt(e)};var Et=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Bt="[object AsyncFunction]",jt="[object Function]",Pt="[object GeneratorFunction]",Ct="[object Proxy]";var Lt,zt=function(e){if(!Et(e))return!1;var t=Ft(e);return t==jt||t==Pt||t==Bt||t==Ct},Mt=kt["__core-js_shared__"],Dt=(Lt=/[^.]+$/.exec(Mt&&Mt.keys&&Mt.keys.IE_PROTO||""))?"Symbol(src)_1."+Lt:"";var Rt=function(e){return!!Dt&&Dt in e},It=Function.prototype.toString;var Jt=function(e){if(null!=e){try{return It.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Kt=/^\[object .+?Constructor\]$/,Ut=Function.prototype,Vt=Object.prototype,Wt=Ut.toString,qt=Vt.hasOwnProperty,$t=RegExp("^"+Wt.call(qt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Ht=function(e){return!(!Et(e)||Rt(e))&&(zt(e)?$t:Kt).test(Jt(e))};var Gt=function(e,t){return null==e?void 0:e[t]};var Yt=function(e,t){var r=Gt(e,t);return Ht(r)?r:void 0},Zt=Yt(kt,"Map"),Xt=Yt(Object,"create");var Qt=function(){this.__data__=Xt?Xt(null):{},this.size=0};var er=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},tr="__lodash_hash_undefined__",rr=Object.prototype.hasOwnProperty;var nr=function(e){var t=this.__data__;if(Xt){var r=t[e];return r===tr?void 0:r}return rr.call(t,e)?t[e]:void 0},or=Object.prototype.hasOwnProperty;var ar=function(e){var t=this.__data__;return Xt?void 0!==t[e]:or.call(t,e)},ir="__lodash_hash_undefined__";var sr=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Xt&&void 0===t?ir:t,this};function ur(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ur.prototype.clear=Qt,ur.prototype.delete=er,ur.prototype.get=nr,ur.prototype.has=ar,ur.prototype.set=sr;var cr=ur;var lr=function(){this.size=0,this.__data__={hash:new cr,map:new(Zt||lt),string:new cr}};var fr=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var vr=function(e,t){var r=e.__data__;return fr(t)?r["string"==typeof t?"string":"hash"]:r.map};var dr=function(e){var t=vr(this,e).delete(e);return this.size-=t?1:0,t};var hr=function(e){return vr(this,e).get(e)};var yr=function(e){return vr(this,e).has(e)};var pr=function(e,t){var r=vr(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function kr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}kr.prototype.clear=lr,kr.prototype.delete=dr,kr.prototype.get=hr,kr.prototype.has=yr,kr.prototype.set=pr;var mr=kr,gr=200;var br=function(e,t){var r=this.__data__;if(r instanceof lt){var n=r.__data__;if(!Zt||n.length<gr-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new mr(n)}return r.set(e,t),this.size=r.size,this};function Ar(e){var t=this.__data__=new lt(e);this.size=t.size}Ar.prototype.clear=ft,Ar.prototype.delete=vt,Ar.prototype.get=dt,Ar.prototype.has=ht,Ar.prototype.set=br;var xr=Ar;var Or=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},Tr=function(){try{var e=Yt(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Nr=function(e,t,r){"__proto__"==t&&Tr?Tr(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},wr=Object.prototype.hasOwnProperty;var _r=function(e,t,r){var n=e[t];wr.call(e,t)&&rt(n,r)&&(void 0!==r||t in e)||Nr(e,t,r)};var Sr=function(e,t,r,n){var o=!r;r||(r={});for(var a=-1,i=t.length;++a<i;){var s=t[a],u=n?n(r[s],e[s],s,r,e):void 0;void 0===u&&(u=e[s]),o?Nr(r,s,u):_r(r,s,u)}return r};var Fr=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var Er=function(e){return null!=e&&"object"==typeof e},Br="[object Arguments]";var jr=function(e){return Er(e)&&Ft(e)==Br},Pr=Object.prototype,Cr=Pr.hasOwnProperty,Lr=Pr.propertyIsEnumerable,zr=jr(function(){return arguments}())?jr:function(e){return Er(e)&&Cr.call(e,"callee")&&!Lr.call(e,"callee")},Mr=Array.isArray;var Dr=function(){return!1},Rr=de(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?kt.Buffer:void 0,a=(o?o.isBuffer:void 0)||Dr;e.exports=a}),Ir=9007199254740991,Jr=/^(?:0|[1-9]\d*)$/;var Kr=function(e,t){return!!(t=null==t?Ir:t)&&("number"==typeof e||Jr.test(e))&&e>-1&&e%1==0&&e<t},Ur=9007199254740991;var Vr=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Ur},Wr={};Wr["[object Float32Array]"]=Wr["[object Float64Array]"]=Wr["[object Int8Array]"]=Wr["[object Int16Array]"]=Wr["[object Int32Array]"]=Wr["[object Uint8Array]"]=Wr["[object Uint8ClampedArray]"]=Wr["[object Uint16Array]"]=Wr["[object Uint32Array]"]=!0,Wr["[object Arguments]"]=Wr["[object Array]"]=Wr["[object ArrayBuffer]"]=Wr["[object Boolean]"]=Wr["[object DataView]"]=Wr["[object Date]"]=Wr["[object Error]"]=Wr["[object Function]"]=Wr["[object Map]"]=Wr["[object Number]"]=Wr["[object Object]"]=Wr["[object RegExp]"]=Wr["[object Set]"]=Wr["[object String]"]=Wr["[object WeakMap]"]=!1;var qr=function(e){return Er(e)&&Vr(e.length)&&!!Wr[Ft(e)]};var $r=function(e){return function(t){return e(t)}},Hr=de(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r&&yt.process,a=function(){try{return o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=a}),Gr=Hr&&Hr.isTypedArray,Yr=Gr?$r(Gr):qr,Zr=Object.prototype.hasOwnProperty;var Xr=function(e,t){var r=Mr(e),n=!r&&zr(e),o=!r&&!n&&Rr(e),a=!r&&!n&&!o&&Yr(e),i=r||n||o||a,s=i?Fr(e.length,String):[],u=s.length;for(var c in e)!t&&!Zr.call(e,c)||i&&("length"==c||o&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Kr(c,u))||s.push(c);return s},Qr=Object.prototype;var en=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Qr)};var tn=function(e,t){return function(r){return e(t(r))}},rn=tn(Object.keys,Object),nn=Object.prototype.hasOwnProperty;var on=function(e){if(!en(e))return rn(e);var t=[];for(var r in Object(e))nn.call(e,r)&&"constructor"!=r&&t.push(r);return t};var an=function(e){return null!=e&&Vr(e.length)&&!zt(e)};var sn=function(e){return an(e)?Xr(e):on(e)};var un=function(e,t){return e&&Sr(t,sn(t),e)};var cn=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},ln=Object.prototype.hasOwnProperty;var fn=function(e){if(!Et(e))return cn(e);var t=en(e),r=[];for(var n in e)("constructor"!=n||!t&&ln.call(e,n))&&r.push(n);return r};var vn=function(e){return an(e)?Xr(e,!0):fn(e)};var dn=function(e,t){return e&&Sr(t,vn(t),e)},hn=de(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?kt.Buffer:void 0,a=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=a?a(r):new e.constructor(r);return e.copy(n),n}});var yn=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var pn=function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,a=[];++r<n;){var i=e[r];t(i,r,e)&&(a[o++]=i)}return a};var kn=function(){return[]},mn=Object.prototype.propertyIsEnumerable,gn=Object.getOwnPropertySymbols,bn=gn?function(e){return null==e?[]:(e=Object(e),pn(gn(e),function(t){return mn.call(e,t)}))}:kn;var An=function(e,t){return Sr(e,bn(e),t)};var xn=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e},On=tn(Object.getPrototypeOf,Object),Tn=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)xn(t,bn(e)),e=On(e);return t}:kn;var Nn=function(e,t){return Sr(e,Tn(e),t)};var wn=function(e,t,r){var n=t(e);return Mr(e)?n:xn(n,r(e))};var _n=function(e){return wn(e,sn,bn)};var Sn=function(e){return wn(e,vn,Tn)},Fn=Yt(kt,"DataView"),En=Yt(kt,"Promise"),Bn=Yt(kt,"Set"),jn=Yt(kt,"WeakMap"),Pn=Jt(Fn),Cn=Jt(Zt),Ln=Jt(En),zn=Jt(Bn),Mn=Jt(jn),Dn=Ft;(Fn&&"[object DataView]"!=Dn(new Fn(new ArrayBuffer(1)))||Zt&&"[object Map]"!=Dn(new Zt)||En&&"[object Promise]"!=Dn(En.resolve())||Bn&&"[object Set]"!=Dn(new Bn)||jn&&"[object WeakMap]"!=Dn(new jn))&&(Dn=function(e){var t=Ft(e),r="[object Object]"==t?e.constructor:void 0,n=r?Jt(r):"";if(n)switch(n){case Pn:return"[object DataView]";case Cn:return"[object Map]";case Ln:return"[object Promise]";case zn:return"[object Set]";case Mn:return"[object WeakMap]"}return t});var Rn=Dn,In=Object.prototype.hasOwnProperty;var Jn=function(e){var t=e.length,r=e.constructor(t);return t&&"string"==typeof e[0]&&In.call(e,"index")&&(r.index=e.index,r.input=e.input),r},Kn=kt.Uint8Array;var Un=function(e){var t=new e.constructor(e.byteLength);return new Kn(t).set(new Kn(e)),t};var Vn=function(e,t){var r=t?Un(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)};var Wn=function(e,t){return e.set(t[0],t[1]),e};var qn=function(e,t,r,n){var o=-1,a=null==e?0:e.length;for(n&&a&&(r=e[++o]);++o<a;)r=t(r,e[o],o,e);return r};var $n=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r},Hn=1;var Gn=function(e,t,r){var n=t?r($n(e),Hn):$n(e);return qn(n,Wn,new e.constructor)},Yn=/\w*$/;var Zn=function(e){var t=new e.constructor(e.source,Yn.exec(e));return t.lastIndex=e.lastIndex,t};var Xn=function(e,t){return e.add(t),e};var Qn=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r},eo=1;var to=function(e,t,r){var n=t?r(Qn(e),eo):Qn(e);return qn(n,Xn,new e.constructor)},ro=mt?mt.prototype:void 0,no=ro?ro.valueOf:void 0;var oo=function(e){return no?Object(no.call(e)):{}};var ao=function(e,t){var r=t?Un(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},io="[object Boolean]",so="[object Date]",uo="[object Map]",co="[object Number]",lo="[object RegExp]",fo="[object Set]",vo="[object String]",ho="[object Symbol]",yo="[object ArrayBuffer]",po="[object DataView]",ko="[object Float32Array]",mo="[object Float64Array]",go="[object Int8Array]",bo="[object Int16Array]",Ao="[object Int32Array]",xo="[object Uint8Array]",Oo="[object Uint8ClampedArray]",To="[object Uint16Array]",No="[object Uint32Array]";var wo=function(e,t,r,n){var o=e.constructor;switch(t){case yo:return Un(e);case io:case so:return new o(+e);case po:return Vn(e,n);case ko:case mo:case go:case bo:case Ao:case xo:case Oo:case To:case No:return ao(e,n);case uo:return Gn(e,n,r);case co:case vo:return new o(e);case lo:return Zn(e);case fo:return to(e,n,r);case ho:return oo(e)}},_o=Object.create,So=function(){function e(){}return function(t){if(!Et(t))return{};if(_o)return _o(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();var Fo=function(e){return"function"!=typeof e.constructor||en(e)?{}:So(On(e))},Eo=1,Bo=2,jo=4,Po="[object Arguments]",Co="[object Function]",Lo="[object GeneratorFunction]",zo="[object Object]",Mo={};Mo[Po]=Mo["[object Array]"]=Mo["[object ArrayBuffer]"]=Mo["[object DataView]"]=Mo["[object Boolean]"]=Mo["[object Date]"]=Mo["[object Float32Array]"]=Mo["[object Float64Array]"]=Mo["[object Int8Array]"]=Mo["[object Int16Array]"]=Mo["[object Int32Array]"]=Mo["[object Map]"]=Mo["[object Number]"]=Mo[zo]=Mo["[object RegExp]"]=Mo["[object Set]"]=Mo["[object String]"]=Mo["[object Symbol]"]=Mo["[object Uint8Array]"]=Mo["[object Uint8ClampedArray]"]=Mo["[object Uint16Array]"]=Mo["[object Uint32Array]"]=!0,Mo["[object Error]"]=Mo[Co]=Mo["[object WeakMap]"]=!1;var Do=function e(t,r,n,o,a,i){var s,u=r&Eo,c=r&Bo,l=r&jo;if(n&&(s=a?n(t,o,a,i):n(t)),void 0!==s)return s;if(!Et(t))return t;var f=Mr(t);if(f){if(s=Jn(t),!u)return yn(t,s)}else{var v=Rn(t),d=v==Co||v==Lo;if(Rr(t))return hn(t,u);if(v==zo||v==Po||d&&!a){if(s=c||d?{}:Fo(t),!u)return c?Nn(t,dn(s,t)):An(t,un(s,t))}else{if(!Mo[v])return a?t:{};s=wo(t,v,e,u)}}i||(i=new xr);var h=i.get(t);if(h)return h;i.set(t,s);var y=l?c?Sn:_n:c?keysIn:sn,p=f?void 0:y(t);return Or(p||t,function(o,a){p&&(o=t[a=o]),_r(s,a,e(o,r,n,a,t,i))}),s},Ro="[object Symbol]";var Io=function(e){return"symbol"==typeof e||Er(e)&&Ft(e)==Ro},Jo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ko=/^\w*$/;var Uo=function(e,t){if(Mr(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Io(e))||Ko.test(e)||!Jo.test(e)||null!=t&&e in Object(t)},Vo="Expected a function";function Wo(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Vo);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],a=r.cache;if(a.has(o))return a.get(o);var i=e.apply(this,n);return r.cache=a.set(o,i)||a,i};return r.cache=new(Wo.Cache||mr),r}Wo.Cache=mr;var qo=Wo,$o=500;var Ho=/^\./,Go=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Yo=/\\(\\)?/g,Zo=function(e){var t=qo(e,function(e){return r.size===$o&&r.clear(),e}),r=t.cache;return t}(function(e){var t=[];return Ho.test(e)&&t.push(""),e.replace(Go,function(e,r,n,o){t.push(n?o.replace(Yo,"$1"):r||e)}),t}),Xo=1/0,Qo=mt?mt.prototype:void 0,ea=Qo?Qo.toString:void 0;var ta=function e(t){if("string"==typeof t)return t;if(Mr(t))return et(t,e)+"";if(Io(t))return ea?ea.call(t):"";var r=t+"";return"0"==r&&1/t==-Xo?"-0":r};var ra=function(e){return null==e?"":ta(e)};var na=function(e,t){return Mr(e)?e:Uo(e,t)?[e]:Zo(ra(e))};var oa=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0},aa=1/0;var ia=function(e){if("string"==typeof e||Io(e))return e;var t=e+"";return"0"==t&&1/e==-aa?"-0":t};var sa=function(e,t){for(var r=0,n=(t=na(t,e)).length;null!=e&&r<n;)e=e[ia(t[r++])];return r&&r==n?e:void 0};var ua=function(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(o);++n<o;)a[n]=e[n+t];return a};var ca=function(e,t){return t.length<2?e:sa(e,ua(t,0,-1))};var la=function(e,t){return t=na(t,e),null==(e=ca(e,t))||delete e[ia(oa(t))]},fa="[object Object]",va=Function.prototype,da=Object.prototype,ha=va.toString,ya=da.hasOwnProperty,pa=ha.call(Object);var ka=function(e){if(!Er(e)||Ft(e)!=fa)return!1;var t=On(e);if(null===t)return!0;var r=ya.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&ha.call(r)==pa};var ma=function(e){return ka(e)?void 0:e},ga=mt?mt.isConcatSpreadable:void 0;var ba=function(e){return Mr(e)||zr(e)||!!(ga&&e&&e[ga])};var Aa=function e(t,r,n,o,a){var i=-1,s=t.length;for(n||(n=ba),a||(a=[]);++i<s;){var u=t[i];r>0&&n(u)?r>1?e(u,r-1,n,o,a):xn(a,u):o||(a[a.length]=u)}return a};var xa=function(e){return null!=e&&e.length?Aa(e,1):[]};var Oa=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},Ta=Math.max;var Na=function(e,t,r){return t=Ta(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,a=Ta(n.length-t,0),i=Array(a);++o<a;)i[o]=n[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=n[o];return s[t]=r(i),Oa(e,this,s)}};var wa=function(e){return function(){return e}};var _a=Tr?function(e,t){return Tr(e,"toString",{configurable:!0,enumerable:!1,value:wa(t),writable:!0})}:function(e){return e},Sa=800,Fa=16,Ea=Date.now;var Ba=function(e){var t=0,r=0;return function(){var n=Ea(),o=Fa-(n-r);if(r=n,o>0){if(++t>=Sa)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(_a);var ja=function(e){return Ba(Na(e,void 0,xa),e+"")},Pa=ja(function(e,t){var r={};if(null==e)return r;var n=!1;t=et(t,function(t){return t=na(t,e),n||(n=t.length>1),t}),Sr(e,Sn(e),r),n&&(r=Do(r,7,ma));for(var o=t.length;o--;)la(r,t[o]);return r}),Ca={};Ca.redo=function(e){var t=e.value,r=t.history;if(r){var n=r,o=n.undos,a=n.redos,i=a.peek();i&&(a=a.pop(),o=o.push(i),i.forEach(function(t){var r=t,n=r.type,o=r.properties;"set_selection"==n&&(t=t.set("properties",Pa(o,"isFocused"))),e.withoutSaving(function(){e.applyOperation(t)})}),t=e.value,r=r.set("undos",o).set("redos",a),t=t.set("history",r),e.value=t)}},Ca.undo=function(e){var t=e.value,r=t.history;if(r){var n=r,o=n.undos,a=n.redos,i=o.peek();i&&(o=o.pop(),a=a.push(i),i.slice().reverse().map(function(e){return e.invert()}).forEach(function(t){var r=t,n=r.type,o=r.properties;"set_selection"==n&&(t=t.set("properties",Pa(o,"isFocused"))),e.withoutSaving(function(){e.applyOperation(t)})}),t=e.value,r=r.set("undos",o).set("redos",a),t=t.set("history",r),e.value=t)}};var La=function(e,t,r,n){if(!Et(e))return e;for(var o=-1,a=(t=na(t,e)).length,i=a-1,s=e;null!=s&&++o<a;){var u=ia(t[o]),c=r;if(o!=i){var l=s[u];void 0===(c=n?n(l,u,s):void 0)&&(c=Et(l)?l:Kr(t[o+1])?[]:{})}_r(s,u,c),s=s[u]}return e};var za=function(e,t,r){for(var n=-1,o=t.length,a={};++n<o;){var i=t[n],s=sa(e,i);r(s,i)&&La(a,na(i,e),s)}return a};var Ma=function(e,t){return null!=e&&t in Object(e)};var Da=function(e,t,r){for(var n=-1,o=(t=na(t,e)).length,a=!1;++n<o;){var i=ia(t[n]);if(!(a=null!=e&&r(e,i)))break;e=e[i]}return a||++n!=o?a:!!(o=null==e?0:e.length)&&Vr(o)&&Kr(i,o)&&(Mr(e)||zr(e))};var Ra=function(e,t){return null!=e&&Da(e,t,Ma)};var Ia=function(e,t){return za(e,t,function(t,r){return Ra(e,r)})},Ja=ja(function(e,t){return null==e?{}:Ia(e,t)}),Ka={key:void 0,offset:void 0,path:void 0},Ua=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h(t,e),v(t,[{key:"isAtEndOfNode",value:function(e){if(this.isUnset)return!1;var t=e.getLastText();return this.key===t.key&&this.offset===t.text.length}},{key:"isAtStartOfNode",value:function(e){if(this.isUnset)return!1;if(0!=this.offset)return!1;var t=e.getFirstText();return this.key===t.key}},{key:"isInNode",value:function(e){return!this.isUnset&&("text"===e.object&&e.key===this.key||!!e.hasNode(this.key))}},{key:"moveBackward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return 0===e?this:e<0?this.moveForward(-e):this.setOffset(this.offset-e)}},{key:"moveForward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return 0===e?this:e<0?this.moveBackward(-e):this.setOffset(this.offset+e)}},{key:"moveTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.key;return"number"==typeof e?(t=e,e=this.path):"string"==typeof e?e=(r=e)===this.key?this.path:null:r=e.equals(this.path)?this.key:null,this.merge({key:r,path:e,offset:t})}},{key:"moveToStartOfNode",value:function(e){var t=e.getFirstText();return this.moveTo(t.key,0)}},{key:"moveToEndOfNode",value:function(e){var t=e.getLastText();return this.moveTo(t.key,t.text.length)}},{key:"normalize",value:function(e){if(null==this.key&&null==this.path)return this.setOffset(null);var r=this.key,n=this.offset,o=this.path,a=e.getNode(r||o);if(!a){c(!1,"A point's `path` or `key` invalid and was reset!");var i=e.getFirstText();return i?this.merge({key:i.key,offset:0,path:e.getPath(i.key)}):t.create()}if("text"!==a.object){c(!1,"A point should not reference a non-text node!");var s=a.getTextAtOffset(n),u=a.getOffset(s.key);return this.merge({offset:n-u,key:s.key,path:e.getPath(s.key)})}return a&&o&&r&&r!==a.key&&c(!1,"A point's `key` did not match its `path`!"),this.merge({key:a.key,path:null==o?e.getPath(a.key):o,offset:null==n?0:Math.min(n,a.text.length)})}},{key:"setKey",value:function(e){return null!==e&&(e=u.create(e)),this.set("key",e)}},{key:"setOffset",value:function(e){return this.set("offset",e)}},{key:"setPath",value:function(e){return null!==e&&(e=qe.create(e)),this.set("path",e)}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,key:this.key,offset:this.offset,path:this.path&&this.path.toArray()};return e.preserveKeys||delete t.key,t}},{key:"unset",value:function(){return this.merge({key:null,offset:null,path:null})}},{key:"isSet",get:function(){return null!=this.key&&null!=this.offset&&null!=this.path}},{key:"isUnset",get:function(){return!this.isSet}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.isPoint(e))return e;if(o(e))return t.fromJSON(e);throw new Error("`Point.create` only accepts objects or points, but you passed it: "+e)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.isPoint(e))return{key:e.key,offset:e.offset,path:e.path};if(o(e)){var r={};return"key"in e&&(r.key=e.key),"offset"in e&&(r.offset=e.offset),"path"in e&&(r.path=qe.create(e.path)),"path"in e&&!("key"in e)&&(r.key=null),"key"in e&&!("path"in e)&&(r.path=null),r}throw new Error("`Point.createProperties` only accepts objects or points, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var r=e.key,n=void 0===r?null:r,o=e.offset,a=void 0===o?null:o,i=e.path,s=void 0===i?null:i;return new t({key:n,offset:a,path:qe.create(s)})}}]),t}(t.Record(Ka)),Va={anchor:void 0,focus:void 0,mark:void 0},Wa=function(e){function r(){return f(this,r),p(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return h(r,e),v(r,[{key:"setProperties",value:function(e){var t=e=r.createProperties(e),n=t.anchor,o=t.focus,a=t.mark,i={};return n&&(i.anchor=Ua.create(n)),o&&(i.focus=Ua.create(o)),a&&(i.mark=N.create(a)),this.merge(i)}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{object:this.object,anchor:this.anchor.toJSON(e),focus:this.focus.toJSON(e),mark:this.mark.toJSON(e)}}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isDecoration(e))return e;if(Ga.isRange(e))return r.fromJSON(Ga.createProperties(e));if(o(e))return r.fromJSON(e);throw new Error("`Decoration.create` only accepts objects or decorations, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e)||Array.isArray(e))return new t.List(e.map(r.create));throw new Error("`Decoration.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isDecoration(e))return{anchor:Ua.createProperties(e.anchor),focus:Ua.createProperties(e.focus),mark:N.create(e.mark)};if(o(e)){var t={};return"anchor"in e&&(t.anchor=Ua.create(e.anchor)),"focus"in e&&(t.focus=Ua.create(e.focus)),"mark"in e&&(t.mark=N.create(e.mark)),t}throw new Error("`Decoration.createProperties` only accepts objects or decorations, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var t=e.anchor,n=e.focus,o=e.mark;if(!o)throw new Error("Decorations must be created with a `mark`, but you passed: "+JSON.stringify(e));return new r({anchor:Ua.fromJSON(t||{}),focus:Ua.fromJSON(n||{}),mark:N.fromJSON(o)})}}]),r}(t.Record(Va)),qa={block:"@@__SLATE_BLOCK__@@",change:"@@__SLATE_CHANGE__@@",decoration:"@@__SLATE_DECORATION__@@",document:"@@__SLATE_DOCUMENT__@@",history:"@@__SLATE_HISTORY__@@",inline:"@@__SLATE_INLINE__@@",leaf:"@@__SLATE_LEAF__@@",mark:"@@__SLATE_MARK__@@",operation:"@@__SLATE_OPERATION__@@",point:"@@__SLATE_POINT__@@",range:"@@__SLATE_RANGE__@@",schema:"@@__SLATE_SCHEMA__@@",selection:"@@__SLATE_SELECTION__@@",stack:"@@__SLATE_STACK__@@",text:"@@__SLATE_TEXT__@@",value:"@@__SLATE_VALUE__@@"};function $a(e,t){return!(!t||!t[qa[e]])}var Ha={anchor:void 0,focus:void 0},Ga=function(e){function r(){return f(this,r),p(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return h(r,e),v(r,[{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{object:this.object,anchor:this.anchor.toJSON(e),focus:this.focus.toJSON(e)}}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isRange(e))return"range"===e.object?e:r.fromJSON(r.createProperties(e));if(o(e))return r.fromJSON(e);throw new Error("`Range.create` only accepts objects or ranges, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e)||Array.isArray(e))return new t.List(e.map(r.create));throw new Error("`Range.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isRange(e))return{anchor:Ua.createProperties(e.anchor),focus:Ua.createProperties(e.focus)};if(o(e)){var t={};return"anchor"in e&&(t.anchor=Ua.create(e.anchor)),"focus"in e&&(t.focus=Ua.create(e.focus)),t}throw new Error("`Range.createProperties` only accepts objects, decorations, ranges or selections, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var t=e.anchor,n=e.focus;return new r({anchor:Ua.fromJSON(t||{}),focus:Ua.fromJSON(n||{})})}},{key:"isRange",value:function(e){return $a("range",e)||Wa.isDecoration(e)||Za.isSelection(e)}}]),r}(t.Record(Ha)),Ya={anchor:void 0,focus:void 0,isFocused:void 0,marks:void 0},Za=function(e){function r(){return f(this,r),p(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return h(r,e),v(r,[{key:"setIsFocused",value:function(e){return this.set("isFocused",e)}},{key:"setMarks",value:function(e){return this.set("marks",e)}},{key:"setProperties",value:function(e){var t=e=r.createProperties(e),n=t.anchor,o=t.focus,a=y(t,["anchor","focus"]);return n&&(a.anchor=Ua.create(n)),o&&(a.focus=Ua.create(o)),this.merge(a)}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{object:this.object,anchor:this.anchor.toJSON(e),focus:this.focus.toJSON(e),isFocused:this.isFocused,marks:null==this.marks?null:this.marks.toArray().map(function(e){return e.toJSON()})}}},{key:"isBlurred",get:function(){return!this.isFocused}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isSelection(e))return e;if(Ga.isRange(e))return r.fromJSON(Ga.createProperties(e));if(o(e))return r.fromJSON(e);throw new Error("`Selection.create` only accepts objects, ranges or selections, but you passed it: "+e)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isSelection(e))return{anchor:Ua.createProperties(e.anchor),focus:Ua.createProperties(e.focus),isFocused:e.isFocused,marks:e.marks};if(Ga.isRange(e))return{anchor:Ua.createProperties(e.anchor),focus:Ua.createProperties(e.focus)};if(o(e)){var t={};return"anchor"in e&&(t.anchor=Ua.create(e.anchor)),"focus"in e&&(t.focus=Ua.create(e.focus)),"isFocused"in e&&(t.isFocused=e.isFocused),"marks"in e&&(t.marks=null==e.marks?null:N.createSet(e.marks)),t}throw new Error("`Selection.createProperties` only accepts objects, ranges or selections, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var n=e.anchor,o=e.focus,a=e.isFocused,i=void 0!==a&&a,s=e.marks,u=void 0===s?null:s;return new r({anchor:Ua.fromJSON(n||{}),focus:Ua.fromJSON(o||{}),isFocused:i,marks:null==u?null:new t.Set(u.map(N.fromJSON))})}}]),r}(t.Record(Ya)),Xa={};function Qa(e,t){for(var r,n=arguments.length,o=Array(n>2?n-2:0),a=2;a<n;a++)o[a-2]=arguments[a];var i=(r=e.value.selection)[t].apply(r,o);e.select(i)}function ei(e,t,r,n){var o=t.slice(0,1).toUpperCase()+t.slice(1),a=r.slice(0,1).toUpperCase()+r.slice(1),i=n.slice(0,1).toUpperCase()+n.slice(1),s="move"+o+"To"+a+"OfNode",u="text"==n?"getNode":"getClosest"+i,c=e.value,l=c.document,f=c.selection[t],v=l[u](f.key);v&&e[s](v)}function ti(e,t,r,n,o){var a=t.slice(0,1).toUpperCase()+t.slice(1),i=r.slice(0,1).toUpperCase()+r.slice(1),s=n.slice(0,1).toUpperCase()+n.slice(1),u=o.slice(0,1).toUpperCase()+o.slice(1),c="move"+a+"To"+i+"OfNode",l="text"==o?"getNode":"getClosest"+u,f="get"+s+u,v=e.value,d=v.document,h=v.selection[t],y=d[l](h.key);if(y){var p=d[f](y.key);p&&e[c](p)}}function ri(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0!==r){if(r<0)return ni(e,t,-r);var n=t.slice(0,1).toUpperCase()+t.slice(1),o=e.value,a=o.document,i=o.selection,s=o.schema,u=i[t],c=a.hasVoidParent(u.path,s);if(!c&&u.offset-r>=0){var l=i["move"+n+"Backward"](r);e.select(l)}else{var f=a.getPreviousText(u.path);if(f){var v=a.getClosestBlock(u.path).hasNode(f.key),d=f&&a.hasVoidParent(f.key,s);if(e["move"+n+"ToEndOfNode"](f),!c&&!d&&v){var h=e.value.selection["move"+n+"Backward"](r);e.select(h)}}}}}function ni(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0!==r){if(r<0)return ri(e,t,-r);var n=t.slice(0,1).toUpperCase()+t.slice(1),o=e.value,a=o.document,i=o.selection,s=o.schema,u=i[t],c=a.getNode(u.path),l=a.hasVoidParent(u.path,s);if(!l&&u.offset+r<=c.text.length){var f=i["move"+n+"Forward"](r);e.select(f)}else{var v=a.getNextText(u.path);if(v){var d=a.getClosestBlock(u.path).hasNode(v.key),h=a.hasVoidParent(v.key,s);if(e["move"+n+"ToStartOfNode"](v),!l&&!h&&d){var y=e.value.selection["move"+n+"Forward"](r);e.select(y)}}}}}Xa.blur=function(e){e.select({isFocused:!1})},Xa.deselect=function(e){var t=Za.create();e.select(t)},Xa.focus=function(e){e.select({isFocused:!0})},Xa.flip=function(e){e.call(Qa,"flip")},Xa.moveAnchorBackward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ri,"anchor"].concat(r))},Xa.moveAnchorForward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ni,"anchor"].concat(r))},Xa.moveAnchorTo=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveAnchorTo"].concat(r))},Xa.moveAnchorToEndOfBlock=function(e){e.call(ei,"anchor","end","block")},Xa.moveAnchorToEndOfInline=function(e){e.call(ei,"anchor","end","inline")},Xa.moveAnchorToEndOfDocument=function(e){e.moveAnchorToEndOfNode(e.value.document).moveToAnchor()},Xa.moveAnchorToEndOfNextBlock=function(e){e.call(ti,"anchor","end","next","block")},Xa.moveAnchorToEndOfNextInline=function(e){e.call(ti,"anchor","end","next","inline")},Xa.moveAnchorToEndOfNextText=function(e){e.call(ti,"anchor","end","next","text")},Xa.moveAnchorToEndOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveAnchorToEndOfNode"].concat(r))},Xa.moveAnchorToEndOfPreviousBlock=function(e){e.call(ti,"anchor","end","previous","block")},Xa.moveAnchorToEndOfPreviousInline=function(e){e.call(ti,"anchor","end","previous","inline")},Xa.moveAnchorToEndOfPreviousText=function(e){e.call(ti,"anchor","end","previous","text")},Xa.moveAnchorToEndOfText=function(e){e.call(ei,"anchor","end","text")},Xa.moveAnchorToStartOfBlock=function(e){e.call(ei,"anchor","start","block")},Xa.moveAnchorToStartOfDocument=function(e){e.moveAnchorToStartOfNode(e.value.document).moveToAnchor()},Xa.moveAnchorToStartOfInline=function(e){e.call(ei,"anchor","start","inline")},Xa.moveAnchorToStartOfNextBlock=function(e){e.call(ti,"anchor","start","next","block")},Xa.moveAnchorToStartOfNextInline=function(e){e.call(ti,"anchor","start","next","inline")},Xa.moveAnchorToStartOfNextText=function(e){e.call(ti,"anchor","start","next","text")},Xa.moveAnchorToStartOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveAnchorToStartOfNode"].concat(r))},Xa.moveAnchorToStartOfPreviousBlock=function(e){e.call(ti,"anchor","start","previous","block")},Xa.moveAnchorToStartOfPreviousInline=function(e){e.call(ti,"anchor","start","previous","inline")},Xa.moveAnchorToStartOfPreviousText=function(e){e.call(ti,"anchor","start","previous","text")},Xa.moveAnchorToStartOfText=function(e){e.call(ei,"anchor","start","text")},Xa.moveBackward=function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(t=e.moveAnchorBackward.apply(e,n)).moveFocusBackward.apply(t,n)},Xa.moveEndBackward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ri,"end"].concat(r))},Xa.moveEndForward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ni,"end"].concat(r))},Xa.moveEndTo=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveEndTo"].concat(r))},Xa.moveEndToEndOfBlock=function(e){e.call(ei,"end","end","block")},Xa.moveEndToEndOfDocument=function(e){e.moveEndToEndOfNode(e.value.document).moveToEnd()},Xa.moveEndToEndOfInline=function(e){e.call(ei,"end","end","inline")},Xa.moveEndToEndOfNextBlock=function(e){e.call(ti,"end","end","next","block")},Xa.moveEndToEndOfNextInline=function(e){e.call(ti,"end","end","next","inline")},Xa.moveEndToEndOfNextText=function(e){e.call(ti,"end","end","next","text")},Xa.moveEndToEndOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveEndToEndOfNode"].concat(r))},Xa.moveEndToEndOfPreviousBlock=function(e){e.call(ti,"end","end","previous","block")},Xa.moveEndToEndOfPreviousInline=function(e){e.call(ti,"end","end","previous","inline")},Xa.moveEndToEndOfPreviousText=function(e){e.call(ti,"end","end","previous","text")},Xa.moveEndToEndOfText=function(e){e.call(ei,"end","end","text")},Xa.moveEndToStartOfBlock=function(e){e.call(ei,"end","start","block")},Xa.moveEndToStartOfDocument=function(e){e.moveEndToStartOfNode(e.value.document).moveToEnd()},Xa.moveEndToStartOfInline=function(e){e.call(ei,"end","start","inline")},Xa.moveEndToStartOfNextBlock=function(e){e.call(ti,"end","start","next","block")},Xa.moveEndToStartOfNextInline=function(e){e.call(ti,"end","start","next","inline")},Xa.moveEndToStartOfNextText=function(e){e.call(ti,"end","start","next","text")},Xa.moveEndToStartOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveEndToStartOfNode"].concat(r))},Xa.moveEndToStartOfPreviousBlock=function(e){e.call(ti,"end","start","previous","block")},Xa.moveEndToStartOfPreviousInline=function(e){e.call(ti,"end","start","previous","inline")},Xa.moveEndToStartOfPreviousText=function(e){e.call(ti,"end","start","previous","text")},Xa.moveEndToStartOfText=function(e){e.call(ei,"end","start","text")},Xa.moveFocusBackward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ri,"focus"].concat(r))},Xa.moveFocusForward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ni,"focus"].concat(r))},Xa.moveFocusTo=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveFocusTo"].concat(r))},Xa.moveFocusToEndOfBlock=function(e){e.call(ei,"focus","end","block")},Xa.moveFocusToEndOfDocument=function(e){e.moveFocusToEndOfNode(e.value.document).moveToFocus()},Xa.moveFocusToEndOfInline=function(e){e.call(ei,"focus","end","inline")},Xa.moveFocusToEndOfNextBlock=function(e){e.call(ti,"focus","end","next","block")},Xa.moveFocusToEndOfNextInline=function(e){e.call(ti,"focus","end","next","inline")},Xa.moveFocusToEndOfNextText=function(e){e.call(ti,"focus","end","next","text")},Xa.moveFocusToEndOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveFocusToEndOfNode"].concat(r))},Xa.moveFocusToEndOfPreviousBlock=function(e){e.call(ti,"focus","end","previous","block")},Xa.moveFocusToEndOfPreviousInline=function(e){e.call(ti,"focus","end","previous","inline")},Xa.moveFocusToEndOfPreviousText=function(e){e.call(ti,"focus","end","previous","text")},Xa.moveFocusToEndOfText=function(e){e.call(ei,"focus","end","text")},Xa.moveFocusToStartOfBlock=function(e){e.call(ei,"focus","start","block")},Xa.moveFocusToStartOfDocument=function(e){e.moveFocusToStartOfNode(e.value.document).moveToFocus()},Xa.moveFocusToStartOfInline=function(e){e.call(ei,"focus","start","inline")},Xa.moveFocusToStartOfNextBlock=function(e){e.call(ti,"focus","start","next","block")},Xa.moveFocusToStartOfNextInline=function(e){e.call(ti,"focus","start","next","inline")},Xa.moveFocusToStartOfNextText=function(e){e.call(ti,"focus","start","next","text")},Xa.moveFocusToStartOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveFocusToStartOfNode"].concat(r))},Xa.moveFocusToStartOfPreviousBlock=function(e){e.call(ti,"focus","start","previous","block")},Xa.moveFocusToStartOfPreviousInline=function(e){e.call(ti,"focus","start","previous","inline")},Xa.moveFocusToStartOfPreviousText=function(e){e.call(ti,"focus","start","previous","text")},Xa.moveFocusToStartOfText=function(e){e.call(ei,"focus","start","text")},Xa.moveForward=function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(t=e.moveAnchorForward.apply(e,n)).moveFocusForward.apply(t,n)},Xa.moveStartBackward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ri,"start"].concat(r))},Xa.moveStartForward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ni,"start"].concat(r))},Xa.moveStartTo=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveStartTo"].concat(r))},Xa.moveStartToEndOfBlock=function(e){e.call(ei,"start","end","block")},Xa.moveStartToEndOfDocument=function(e){e.moveStartToEndOfNode(e.value.document).moveToStart()},Xa.moveStartToEndOfInline=function(e){e.call(ei,"start","end","inline")},Xa.moveStartToEndOfNextBlock=function(e){e.call(ti,"start","end","next","block")},Xa.moveStartToEndOfNextInline=function(e){e.call(ti,"start","end","next","inline")},Xa.moveStartToEndOfNextText=function(e){e.call(ti,"start","end","next","text")},Xa.moveStartToEndOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveStartToEndOfNode"].concat(r))},Xa.moveStartToEndOfPreviousBlock=function(e){e.call(ti,"start","end","previous","block")},Xa.moveStartToEndOfPreviousInline=function(e){e.call(ti,"start","end","previous","inline")},Xa.moveStartToEndOfPreviousText=function(e){e.call(ti,"start","end","previous","text")},Xa.moveStartToEndOfText=function(e){e.call(ei,"start","end","text")},Xa.moveStartToStartOfBlock=function(e){e.call(ei,"start","start","block")},Xa.moveStartToStartOfDocument=function(e){e.moveStartToStartOfNode(e.value.document).moveToStart()},Xa.moveStartToStartOfInline=function(e){e.call(ei,"start","start","inline")},Xa.moveStartToStartOfNextBlock=function(e){e.call(ti,"start","start","next","block")},Xa.moveStartToStartOfNextInline=function(e){e.call(ti,"start","start","next","inline")},Xa.moveStartToStartOfNextText=function(e){e.call(ti,"start","start","next","text")},Xa.moveStartToStartOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveStartToStartOfNode"].concat(r))},Xa.moveStartToStartOfPreviousBlock=function(e){e.call(ti,"start","start","previous","block")},Xa.moveStartToStartOfPreviousInline=function(e){e.call(ti,"start","start","previous","inline")},Xa.moveStartToStartOfPreviousText=function(e){e.call(ti,"start","start","previous","text")},Xa.moveStartToStartOfText=function(e){e.call(ei,"start","start","text")},Xa.moveTo=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveTo"].concat(r))},Xa.moveToAnchor=function(e){e.call(Qa,"moveToAnchor")},Xa.moveToEnd=function(e){e.call(Qa,"moveToEnd")},Xa.moveToEndOfBlock=function(e){e.moveEndToEndOfBlock().moveToEnd()},Xa.moveToEndOfDocument=function(e){e.moveEndToEndOfNode(e.value.document).moveToEnd()},Xa.moveToEndOfInline=function(e){e.moveEndToEndOfInline().moveToEnd()},Xa.moveToEndOfNextBlock=function(e){e.moveEndToEndOfNextBlock().moveToEnd()},Xa.moveToEndOfNextInline=function(e){e.moveEndToEndOfNextInline().moveToEnd()},Xa.moveToEndOfNextText=function(e){e.moveEndToEndOfNextText().moveToEnd()},Xa.moveToEndOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveToEndOfNode"].concat(r))},Xa.moveToEndOfPreviousBlock=function(e){e.moveStartToEndOfPreviousBlock().moveToStart()},Xa.moveToEndOfPreviousInline=function(e){e.moveStartToEndOfPreviousInline().moveToStart()},Xa.moveToEndOfPreviousText=function(e){e.moveStartToEndOfPreviousText().moveToStart()},Xa.moveToEndOfText=function(e){e.moveEndToEndOfText().moveToEnd()},Xa.moveToFocus=function(e){e.call(Qa,"moveToFocus")},Xa.moveToRangeOfDocument=function(e){e.moveToRangeOfNode(e.value.document)},Xa.moveToRangeOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveToRangeOfNode"].concat(r))},Xa.moveToStart=function(e){e.call(Qa,"moveToStart")},Xa.moveToStartOfBlock=function(e){e.moveStartToStartOfBlock().moveToStart()},Xa.moveToStartOfDocument=function(e){e.moveStartToStartOfNode(e.value.document).moveToStart()},Xa.moveToStartOfInline=function(e){e.moveStartToStartOfInline().moveToStart()},Xa.moveToStartOfNextBlock=function(e){e.moveEndToStartOfNextBlock().moveToEnd()},Xa.moveToStartOfNextInline=function(e){e.moveEndToStartOfNextInline().moveToEnd()},Xa.moveToStartOfNextText=function(e){e.moveEndToStartOfNextText().moveToEnd()},Xa.moveToStartOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"moveToStartOfNode"].concat(r))},Xa.moveToStartOfPreviousBlock=function(e){e.moveStartToStartOfPreviousBlock().moveToStart()},Xa.moveToStartOfPreviousInline=function(e){e.moveStartToStartOfPreviousInline().moveToStart()},Xa.moveToStartOfPreviousText=function(e){e.moveStartToStartOfPreviousText().moveToStart()},Xa.moveToStartOfText=function(e){e.moveStartToStartOfText().moveToStart()},Xa.select=function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r=Za.createProperties(r);var o=n.snapshot,a=void 0!==o&&o,i=e.value,s=i.document,u=i.selection,c={},l=u.setProperties(r);for(var f in l=s.resolveSelection(l),r=Ja(l,Object.keys(r)))!0!==a&&t.is(r[f],u[f])||(c[f]=r[f]);u.marks&&!c.marks&&(c.anchor||c.focus)&&(c.marks=null),0!==Object.keys(c).length&&e.applyOperation({type:"set_selection",value:i,properties:c,selection:u.toJSON()},a?{skip:!1,merge:!1}:{})},Xa.setAnchor=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"setAnchor"].concat(r))},Xa.setEnd=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"setEnd"].concat(r))},Xa.setFocus=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"setFocus"].concat(r))},Xa.setStart=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[Qa,"setStart"].concat(r))},Xa.snapshotSelection=function(e){e.withoutMerging(function(t){return t.select(e.value.selection,{snapshot:!0})})};var oi=xe("slate:history"),ai={redos:void 0,undos:void 0},ii=function(e){function r(){return f(this,r),p(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return h(r,e),v(r,[{key:"save",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this,o=n,a=o.undos,i=o.redos,s=r.merge;if(r.skip)return n;var u,c,l=a.peek(),f=l&&l.last();if(null==s&&(u=e,s=!!(c=f)&&("set_selection"==u.type&&"set_selection"==c.type||"insert_text"==u.type&&"insert_text"==c.type&&u.offset==c.offset+c.text.length&&u.path.equals(c.path)||"remove_text"==u.type&&"remove_text"==c.type&&u.offset+u.text.length==c.offset&&u.path.equals(c.path))),oi("save",{operation:e,merge:s}),s&&l){var v=l.push(e);a=(a=a.pop()).push(v)}else{var d=new t.List([e]);a=a.push(d)}return a.size>100&&(a=a.take(100)),i=i.clear(),n=n.set("undos",a).set("redos",i)}},{key:"toJSON",value:function(){return{object:this.object,redos:this.redos.toJSON(),undos:this.undos.toJSON()}}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isHistory(e))return e;if(o(e))return r.fromJSON(e);throw new Error("`History.create` only accepts objects or histories, but you passed it: "+e)}},{key:"createOperationsList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e))return e;if(Array.isArray(e))return new t.List(e);throw new Error("`History.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var n=e.redos,o=void 0===n?[]:n,a=e.undos,i=void 0===a?[]:a;return new r({redos:new t.Stack(o.map(this.createOperationsList)),undos:new t.Stack(i.map(this.createOperationsList))})}}]),r}(t.Record(ai));var si={plugins:void 0},ui=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h(t,e),v(t,[{key:"getPluginsWith",value:function(e){return this.plugins.filter(function(t){return null!=t[e]})}},{key:"find",value:function(e){for(var t=this.getPluginsWith(e),r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=!0,i=!1,s=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value,f=l[e].apply(l,n);if(null!=f)return f}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}}},{key:"map",value:function(e){for(var t=this.getPluginsWith(e),r=[],n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];var i=!0,s=!1,u=void 0;try{for(var c,l=t[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var f=c.value,v=f[e].apply(f,o);null!=v&&r.push(v)}}catch(e){s=!0,u=e}finally{try{!i&&l.return&&l.return()}finally{if(s)throw u}}return r}},{key:"run",value:function(e){for(var t=this.getPluginsWith(e),r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=!0,i=!1,s=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;if(null!=l[e].apply(l,n))return}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}}},{key:"render",value:function(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return this.getPluginsWith(e).reduceRight(function(r,o){if(!o[e])return r;var a=o[e].apply(o,[t].concat(n));return null==a?r:(t.children=a,a)},void 0===t.children?null:t.children)}}],[{key:"create",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).plugins;return new t({plugins:void 0===e?[]:e})}}]),t}(t.Record(si));P(ui.prototype,["getPluginsWith"]);var ci=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f(this,t);var n=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));for(var o in n.code=e,r)n[o]=r[o];return Error.captureStackTrace?Error.captureStackTrace(n,n.constructor):n.stack=(new Error).stack,n}return h(t,e),t}(Error),li=xe("slate:schema"),fi=[{match:{object:"document"},nodes:[{match:{object:"block"}}]},{match:{object:"block",first:{object:"block"}},nodes:[{match:{object:"block"}}]},{match:{object:"block",first:[{object:"inline"},{object:"text"}]},nodes:[{match:[{object:"inline"},{object:"text"}]}]},{match:{object:"inline"},nodes:[{match:[{object:"inline"},{object:"text"}]}]},{match:[{object:"block"},{object:"inline"}],nodes:[{min:1}],normalize:function(e,t){var r=t.code,n=t.node;"child_required"===r&&e.insertNodeByKey(n.key,0,M.create(),{normalize:!1})}},{match:{object:"block"},first:[{object:"block"},{object:"text"}],last:[{object:"block"},{object:"text"}],normalize:function(e,t){var r=t.code,n=t.node,o=M.create(),a=void 0;if("first_child_object_invalid"===r)a=0;else{if("last_child_object_invalid"!==r)return;a=n.nodes.size}e.insertNodeByKey(n.key,a,o,{normalize:!1})}},{match:{object:"inline"},first:[{object:"block"},{object:"text"}],last:[{object:"block"},{object:"text"}],previous:[{object:"block"},{object:"text"}],next:[{object:"block"},{object:"text"}],normalize:function(e,t){var r=t.code,n=t.node,o=t.index,a=M.create(),i=void 0;if("first_child_object_invalid"===r)i=0;else if("last_child_object_invalid"===r)i=n.nodes.size;else if("previous_sibling_object_invalid"===r)i=o;else{if("next_sibling_object_invalid"!==r)return;i=o+1}e.insertNodeByKey(n.key,i,a,{normalize:!1})}},{match:{object:"text"},next:[{object:"block"},{object:"inline"}],normalize:function(e,t){var r=t.code,n=t.next;"next_sibling_object_invalid"===r&&e.mergeNodeByKey(n.key,{normalize:!1})}}],vi={stack:void 0,rules:void 0},di=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h(t,e),v(t,[{key:"getNodeRules",value:function(e){return this.rules.filter(function(t){return hi(e,t.match)})}},{key:"validateNode",value:function(e){var t=yi(e,this.getNodeRules(e),this.rules,{every:!0});if(t)return new ci(t.code,t)}},{key:"testNode",value:function(e){return!this.validateNode(e)}},{key:"assertNode",value:function(e){var t=this.validateNode(e);if(t)throw t}},{key:"normalizeNode",value:function(e){var t=this.stack.find("normalizeNode",e);if(t)return t;if("text"!=e.object){var r=this.validateNode(e);if(r)return function(e){li("normalizing",{error:r});var t=r.rule,n=e.operations.size;t.normalize&&t.normalize(e,r),e.operations.size===n&&function(e,t){var r=t.code,n=t.node,o=t.child,a=t.next,i=t.previous,s=t.key,u=t.mark;switch(r){case"child_object_invalid":case"child_type_invalid":case"child_unknown":case"first_child_object_invalid":case"first_child_type_invalid":case"last_child_object_invalid":case"last_child_type_invalid":return"text"===o.object&&"block"===n.object&&1===n.nodes.size?e.removeNodeByKey(n.key,{normalize:!1}):e.removeNodeByKey(o.key,{normalize:!1});case"previous_sibling_object_invalid":case"previous_sibling_type_invalid":return"text"===i.object&&"block"===n.object&&1===n.nodes.size?e.removeNodeByKey(n.key,{normalize:!1}):e.removeNodeByKey(i.key,{normalize:!1});case"next_sibling_object_invalid":case"next_sibling_type_invalid":return"text"===a.object&&"block"===n.object&&1===n.nodes.size?e.removeNodeByKey(n.key,{normalize:!1}):e.removeNodeByKey(a.key,{normalize:!1});case"child_required":case"node_text_invalid":case"parent_object_invalid":case"parent_type_invalid":return"document"===n.object?n.nodes.forEach(function(t){return e.removeNodeByKey(t.key,{normalize:!1})}):e.removeNodeByKey(n.key,{normalize:!1});case"node_data_invalid":return void 0===n.data.get(s)&&"document"!==n.object?e.removeNodeByKey(n.key,{normalize:!1}):e.setNodeByKey(n.key,{data:n.data.delete(s)},{normalize:!1});case"node_mark_invalid":return n.getTexts().forEach(function(t){return e.removeMarkByKey(t.key,0,t.text.length,u,{normalize:!1})});default:e.removeNodeByKey(n.key,{normalize:!1})}}(e,r)}}}},{key:"isAtomic",value:function(e){var t=this.rules.find(function(t){return"isAtomic"in t&&hi(e,t.match)});return!!t&&t.isAtomic}},{key:"isVoid",value:function(e){var t=this.rules.find(function(t){return"isVoid"in t&&hi(e,t.match)});return!!t&&t.isVoid}},{key:"toJSON",value:function(){return{object:this.object,rules:this.rules}}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.isSchema(e))return e;if(o(e))return t.fromJSON(e);throw new Error("`Schema.create` only accepts objects or schemas, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(t.isSchema(e))return e;var r=e.plugins?e.plugins:[{schema:e}],n=[].concat(fi),o=!0,a=!1,i=void 0;try{for(var s,u=r[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value.schema,l=void 0===c?{}:c,f=l.blocks,v=void 0===f?{}:f,h=l.inlines,y=void 0===h?{}:h,p=l.marks,k=void 0===p?{}:p;for(var m in l.rules&&(n=n.concat(l.rules)),l.document&&n.push(d({match:[{object:"document"}]},l.document)),v)n.push(d({match:[{object:"block",type:m}]},v[m]));for(var g in y)n.push(d({match:[{object:"inline",type:g}]},y[g]));for(var b in k)n.push(d({match:[{object:"mark",type:b}]},k[b]))}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}return new t({stack:ui.create({plugins:r}),rules:n})}}]),t}(t.Record(vi));function hi(e,t){return!yi(e,t)}function yi(e,t,r){var n=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).every,o=void 0!==n&&n;if(Array.isArray(t)){var a=t.length?t:[{}],i=void 0,s=!0,u=!1,c=void 0;try{for(var f,v=a[Symbol.iterator]();!(s=(f=v.next()).done);s=!0){var d=yi(e,f.value,r);if(i=i||d,o&&d)return d;if(!o&&!d)return}}catch(e){u=!0,c=e}finally{try{!s&&v.return&&v.return()}finally{if(u)throw c}}return i}return function(e,t){if(null==t.object)return;if(t.object===e.object)return;if("function"==typeof t.object&&t.object(e.object))return;return gi("node_object_invalid",{rule:t,node:e})}(e,t)||function(e,t){if(null==t.type)return;if(t.type===e.type)return;if("function"==typeof t.type&&t.type(e.type))return;return gi("node_type_invalid",{rule:t,node:e})}(e,t)||function(e,t){if(null==t.data)return;if(null==e.data)return;if("function"==typeof t.data){if(t.data(e.data))return;return gi("node_data_invalid",{rule:t,node:e})}for(var r in t.data){var n=t.data[r],o=e.data&&e.data.get(r),a="function"==typeof n?n(o):n===o;if(!a)return gi("node_data_invalid",{rule:t,node:e,key:r,value:o})}}(e,t)||function(e,t){if(null==t.marks)return;var r=e.getMarks().toArray(),n=function(r){var n=t.marks.some(function(e){return"function"==typeof e.type?e.type(r.type):e.type===r.type});return n?"continue":{v:gi("node_mark_invalid",{rule:t,node:e,mark:r})}},o=!0,a=!1,i=void 0;try{for(var s,u=r[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,f=n(c);switch(f){case"continue":continue;default:if("object"===(void 0===f?"undefined":l(f)))return f.v}}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}}(e,t)||function(e,t){if(null==t.text)return;var r=e.text;if("function"==typeof t.text?t.text(r):t.text.test(r))return;return gi("node_text_invalid",{rule:t,node:e,text:r})}(e,t)||function(e,t){if(null==t.first)return;var r=e.nodes.first();if(!r)return;var n=yi(r,t.first);if(!n)return;return n.rule=t,n.node=e,n.child=r,n.code=n.code.replace("node_","first_child_"),n}(e,t)||function(e,t){if(null==t.last)return;var r=e.nodes.last();if(!r)return;var n=yi(r,t.last);if(!n)return;return n.rule=t,n.node=e,n.child=r,n.code=n.code.replace("node_","last_child_"),n}(e,t)||function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(null==e.nodes)return;var n=e.nodes.toArray(),o=null!=t.nodes?t.nodes.slice():[],a=void 0,i=void 0,s=void 0,u=void 0,c=void 0,l=void 0,f=void 0,v=void 0;function d(){return a=null==a?null:0,u=o.shift(),i=u&&u.min,c=u&&u.max,!!u}function h(){return s=null==s?0:s+1,a=null==a?0:a+1,f=l,l=n[s],v=n[s+1],null!=c&&a==c&&d(),!!l}function y(){a-=1,s-=1}null!=t.nodes&&d();for(;h();){var p=pi(e,l,r)||ki(e,l,f,s,r)||mi(e,l,v,s,r);if(p)return p;if(null!=t.nodes){if(!u)return gi("child_unknown",{rule:t,node:e,child:l,index:s});if(u.match){var k=yi(l,u.match);if(k&&a>=i&&d()){y();continue}if(k)return k.rule=t,k.node=e,k.child=l,k.index=s,k.code=k.code.replace("node_","child_"),k}}}if(null!=t.nodes)for(;null!=i;){if(a<i)return gi("child_required",{rule:t,node:e,index:s});d()}}(e,t,r)}function pi(e,t,r){var n=!0,o=!1,a=void 0;try{for(var i,s=r[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value;if(null!=u.parent&&hi(t,u.match)){var c=yi(e,u.parent);if(c)return c.rule=u,c.parent=e,c.node=t,c.code=c.code.replace("node_","parent_"),c}}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}}function ki(e,t,r,n,o){if(r){var a=!0,i=!1,s=void 0;try{for(var u,c=o[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;if(null!=l.previous&&hi(t,l.match)){var f=yi(r,l.previous);if(f)return f.rule=l,f.node=e,f.child=t,f.index=n,f.previous=r,f.code=f.code.replace("node_","previous_sibling_"),f}}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}}}function mi(e,t,r,n,o){if(r){var a=!0,i=!1,s=void 0;try{for(var u,c=o[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;if(null!=l.next&&hi(t,l.match)){var f=yi(r,l.next);if(f)return f.rule=l,f.node=e,f.child=t,f.index=n,f.next=r,f.code=f.code.replace("node_","next_sibling_"),f}}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}}}function gi(e,t){return d({code:e},t)}var bi={data:void 0,decorations:void 0,document:void 0,history:void 0,schema:void 0,selection:void 0},Ai=function(e){function r(){return f(this,r),p(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return h(r,e),v(r,[{key:"change",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new ji(d({},e,{value:this}))}},{key:"addMark",value:function(e,t,r,n){var o=this,a=o.document;return a=a.addMark(e,t,r,n),o=this.set("document",a)}},{key:"insertNode",value:function(e,t){var r=this,n=r.document;return n=n.insertNode(e,t),r=(r=r.set("document",n)).mapRanges(function(e){return e.updatePoints(function(e){return e.setPath(null)})})}},{key:"insertText",value:function(e,t,r,n){var o=this,a=o,i=a.document,s=a.schema;i=i.insertText(e,t,r,n),o=o.set("document",i);var u=i.assertNode(e);return o=(o=o.mapRanges(function(e){var n=e,o=n.anchor,a=n.focus,i=n.isBackward,c=Wa.isDecoration(e)&&s.isAtomic(e.mark);return o.key!==u.key||!(o.offset>t)&&(o.offset!==t||c&&i)||(e=e.moveAnchorForward(r.length)),a.key===u.key&&(a.offset>t||a.offset==t&&(!c||i))&&(e=e.moveFocusForward(r.length)),e})).clearAtomicRanges(u.key,t)}},{key:"mergeNode",value:function(e){var t=this,r=t.document,n=r.mergeNode(e);e=r.resolvePath(e);var o=qe.decrement(e),a=r.getNode(o),i=r.getNode(e);return t=(t=t.set("document",n)).mapRanges(function(e){if("text"===i.object){var t=a.text.length;e.anchor.key===i.key&&(e=e.moveAnchorTo(a.key,t+e.anchor.offset)),e.focus.key===i.key&&(e=e.moveFocusTo(a.key,t+e.focus.offset))}return e=e.updatePoints(function(e){return e.setPath(null)})})}},{key:"moveNode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this,o=n.document;return o=o.moveNode(e,t,r),n=(n=n.set("document",o)).mapRanges(function(e){return e.updatePoints(function(e){return e.setPath(null)})})}},{key:"removeMark",value:function(e,t,r,n){var o=this,a=o.document;return a=a.removeMark(e,t,r,n),o=this.set("document",a)}},{key:"removeNode",value:function(e){var t=this,r=t.document,n=r.assertNode(e),o="text"==n.object?n:n.getFirstText()||n,a="text"==n.object?n:n.getLastText()||n,i=r.getPreviousText(o.key),s=r.getNextText(a.key);return r=r.removeNode(e),t=(t=t.set("document",r)).mapRanges(function(e){var t=e,r=t.start,o=t.end;return n.hasNode(r.key)&&(e=i?e.moveStartTo(i.key,i.text.length):s?e.moveStartTo(s.key,0):e.unset()),n.hasNode(o.key)&&(e=i?e.moveEndTo(i.key,i.text.length):s?e.moveEndTo(s.key,0):e.unset()),e=e.updatePoints(function(e){return e.setPath(null)})})}},{key:"removeText",value:function(e,t,r){var n=this,o=n.document;o=o.removeText(e,t,r),n=n.set("document",o);var a=o.assertNode(e),i=r.length,s=t+i;return n=(n=n.clearAtomicRanges(a.key,t,t+i)).mapRanges(function(e){var r=e,n=r.anchor,o=r.focus;return n.key===a.key&&(e=n.offset>=s?e.moveAnchorBackward(i):n.offset>t?e.moveAnchorTo(n.key,t):e),o.key===a.key&&(e=o.offset>=s?e.moveFocusBackward(i):o.offset>t?e.moveFocusTo(o.key,t):e),e})}},{key:"setNode",value:function(e,t){var r=this,n=r.document;return n=n.setNode(e,t),r=r.set("document",n)}},{key:"setMark",value:function(e,t,r,n,o){var a=this,i=a.document;return i=i.setMark(e,t,r,n,o),a=a.set("document",i)}},{key:"setProperties",value:function(e){var t=this,r=t.document,n=e.data,o=e.decorations,a=e.history,i=e.schema,s={};return n&&(s.data=n),a&&(s.history=a),i&&(s.schema=i),o&&(s.decorations=o.map(function(e){return e.isSet?e:r.resolveDecoration(e)})),t=t.merge(s)}},{key:"setSelection",value:function(e){var t=this,r=t,n=r.document,o=r.selection,a=o.setProperties(e);return o=n.resolveSelection(a),t=t.set("selection",o)}},{key:"splitNode",value:function(e,t,r){var n=this,o=n.document,a=o.splitNode(e,t,r),i=o.assertNode(e);return n=(n=n.set("document",a)).mapRanges(function(e){var r=a.getNextText(i.key),n=e,o=n.start,s=n.end;return i.key===o.key&&t<=o.offset&&(e=e.moveStartTo(r.key,o.offset-t)),i.key===s.key&&t<=s.offset&&(e=e.moveEndTo(r.key,s.offset-t)),e=e.updatePoints(function(e){return e.setPath(null)})})}},{key:"mapRanges",value:function(e){var t=this,r=t,n=r.document,o=r.selection,a=r.decorations,i=o.isSet?e(o):o;i||(i=o.unset()),i!==o&&(i=n.createSelection(i)),t=t.set("selection",i);var s=a.map(function(t){var r=t.isSet?e(t):t;return r&&r!==t&&(r=n.createDecoration(r)),r});return s=s.filter(function(e){return!!e}),t=t.set("decorations",s)}},{key:"clearAtomicRanges",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this,o=n.schema;return n=this.mapRanges(function(n){if(!Wa.isDecoration(n))return n;var a=n.start,i=n.end,s=n.mark;return o.isAtomic(s)?a.key!==e?n:a.offset<t&&(i.key!==e||i.offset>t)?null:null!=r&&a.offset<r&&(i.key!==e||i.offset>r)?null:n:n})}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,document:this.document.toJSON(e)};return e.preserveData&&(t.data=this.data.toJSON(e)),e.preserveDecorations&&(t.decorations=this.decorations.toArray().map(function(t){return t.toJSON(e)})),e.preserveHistory&&(t.history=this.history.toJSON(e)),e.preserveSelection&&(t.selection=this.selection.toJSON(e)),e.preserveSchema&&(t.schema=this.schema.toJSON(e)),t}},{key:"startBlock",get:function(){return this.selection.start.key&&this.document.getClosestBlock(this.selection.start.key)}},{key:"endBlock",get:function(){return this.selection.end.key&&this.document.getClosestBlock(this.selection.end.key)}},{key:"anchorBlock",get:function(){return this.selection.anchor.key&&this.document.getClosestBlock(this.selection.anchor.key)}},{key:"focusBlock",get:function(){return this.selection.focus.key&&this.document.getClosestBlock(this.selection.focus.key)}},{key:"startInline",get:function(){return this.selection.start.key&&this.document.getClosestInline(this.selection.start.key)}},{key:"endInline",get:function(){return this.selection.end.key&&this.document.getClosestInline(this.selection.end.key)}},{key:"anchorInline",get:function(){return this.selection.anchor.key&&this.document.getClosestInline(this.selection.anchor.key)}},{key:"focusInline",get:function(){return this.selection.focus.key&&this.document.getClosestInline(this.selection.focus.key)}},{key:"startText",get:function(){return this.selection.start.key&&this.document.getDescendant(this.selection.start.key)}},{key:"endText",get:function(){return this.selection.end.key&&this.document.getDescendant(this.selection.end.key)}},{key:"anchorText",get:function(){return this.selection.anchor.key&&this.document.getDescendant(this.selection.anchor.key)}},{key:"focusText",get:function(){return this.selection.focus.key&&this.document.getDescendant(this.selection.focus.key)}},{key:"nextBlock",get:function(){return this.selection.end.key&&this.document.getNextBlock(this.selection.end.key)}},{key:"previousBlock",get:function(){return this.selection.start.key&&this.document.getPreviousBlock(this.selection.start.key)}},{key:"nextInline",get:function(){return this.selection.end.key&&this.document.getNextInline(this.selection.end.key)}},{key:"previousInline",get:function(){return this.selection.start.key&&this.document.getPreviousInline(this.selection.start.key)}},{key:"nextText",get:function(){return this.selection.end.key&&this.document.getNextText(this.selection.end.key)}},{key:"previousText",get:function(){return this.selection.start.key&&this.document.getPreviousText(this.selection.start.key)}},{key:"marks",get:function(){return this.selection.isUnset?new t.Set:this.selection.marks||this.document.getMarksAtRange(this.selection)}},{key:"activeMarks",get:function(){return this.selection.isUnset?new t.Set:this.selection.marks||this.document.getActiveMarksAtRange(this.selection)}},{key:"blocks",get:function(){return this.selection.isUnset?new t.List:this.document.getBlocksAtRange(this.selection)}},{key:"fragment",get:function(){return this.selection.isUnset?A.create():this.document.getFragmentAtRange(this.selection)}},{key:"inlines",get:function(){return this.selection.isUnset?new t.List:this.document.getInlinesAtRange(this.selection)}},{key:"texts",get:function(){return this.selection.isUnset?new t.List:this.document.getTextsAtRange(this.selection)}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r.isValue(e))return e;if(o(e))return r.fromJSON(e,t);throw new Error("`Value.create` only accepts objects or values, but you passed it: "+e)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isValue(e))return{data:e.data,decorations:e.decorations,schema:e.schema};if(o(e)){var t={};return"data"in e&&(t.data=g.create(e.data)),"decorations"in e&&(t.decorations=Wa.createList(e.decorations)),"schema"in e&&(t.schema=di.create(e.schema)),t}throw new Error("`Value.createProperties` only accepts objects or values, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.data,a=void 0===o?{}:o,i=e.decorations,s=void 0===i?[]:i,u=e.document,c=void 0===u?{}:u,l=e.selection,f=void 0===l?{}:l,v=e.schema,d=void 0===v?{}:v,h=e.history,y=void 0===h?{}:h;if(a=g.fromJSON(a),d=di.fromJSON(d),y=ii.fromJSON(y),f=(c=A.fromJSON(c)).createSelection(f),s=t.List(s.map(function(e){return Wa.fromJSON(e)})),f.isUnset){var p=c.getFirstText();p&&(f=f.moveToStartOfNode(p)),f=c.createSelection(f)}var k=new r({data:a,decorations:s,document:c,selection:f,schema:d,history:y});if(!1!==n.normalize){var m=k.change();m.withoutSaving(function(){return m.normalize()}),k=m.value}return k}}]),r}(t.Record(bi)),xi={setValue:function(e,t){t=Ai.createProperties(t);var r=e.value;e.applyOperation({type:"set_value",properties:t,value:r})}},Oi=d({},Oe,ze,$e,Ca,Xa,xi),Ti=xe("slate:operation:apply");function Ni(e,t){var r=(t=Ei.create(t)).type;switch(Ti(r,t),r){case"add_mark":var n=t,o=n.path,a=n.offset,i=n.length,s=n.mark;return e.addMark(o,a,i,s);case"insert_node":var u=t,c=u.path,l=u.node;return e.insertNode(c,l);case"insert_text":var f=t,v=f.path,d=f.offset,h=f.text,y=f.marks;return e.insertText(v,d,h,y);case"merge_node":var p=t.path;return e.mergeNode(p);case"move_node":var k=t,m=k.path,g=k.newPath;return e.moveNode(m,g);case"remove_mark":var b=t,A=b.path,x=b.offset,O=b.length,T=b.mark;return e.removeMark(A,x,O,T);case"remove_node":var N=t.path;return e.removeNode(N);case"remove_text":var w=t,_=w.path,S=w.offset,F=w.text;return e.removeText(_,S,F);case"set_mark":var E=t,B=E.path,j=E.offset,P=E.length,C=E.mark,L=E.properties;return e.setMark(B,j,P,C,L);case"set_node":var z=t,M=z.path,D=z.properties;return e.setNode(M,D);case"set_selection":var R=t.properties;return e.setSelection(R);case"set_value":var I=t.properties;return e.setProperties(I);case"split_node":var J=t,K=J.path,U=J.position,V=J.properties;return e.splitNode(K,U,V);default:throw new Error('Unknown operation type: "'+r+'".')}}var wi=xe("slate:operation:invert");function _i(e){var t=(e=Ei.create(e)).type;switch(wi(t,e),t){case"insert_node":return e.set("type","remove_node");case"remove_node":return e.set("type","insert_node");case"move_node":var r=e,n=r.newPath,o=r.path,a=n,i=o,s=o.size-1,u=n.size-1;return o.size<a.size&&o.slice(0,s).every(function(e,t){return e==a.get(t)})&&o.last()<a.get(s)&&(a=a.slice(0,s).concat(a.get(s)-1).concat(a.slice(s+1,a.size))),n.size<i.size&&n.slice(0,u).every(function(e,t){return e==i.get(t)})&&n.last()<=i.get(u)&&(i=i.slice(0,u).concat(i.get(u)+1).concat(i.slice(u+1,i.size))),e.set("path",a).set("newPath",i);case"merge_node":var c=e.path,l=qe.decrement(c);return e.set("type","split_node").set("path",l);case"split_node":var f=e.path,v=qe.increment(f);return e.set("type","merge_node").set("path",v);case"set_node":var d=e,h=d.properties,y=d.node,p=y.merge(h),k=Ja(y,Object.keys(h));return e.set("node",p).set("properties",k);case"insert_text":return e.set("type","remove_text");case"remove_text":return e.set("type","insert_text");case"add_mark":return e.set("type","remove_mark");case"remove_mark":return e.set("type","add_mark");case"set_mark":var m=e,g=m.properties,b=m.mark,A=b.merge(g),x=Ja(b,Object.keys(g));return e.set("mark",A).set("properties",x);case"set_selection":var O=e,T=O.properties,N=O.selection,w=N.merge(T),_=Ja(N,Object.keys(T));return e.set("selection",w).set("properties",_);case"set_value":var S=e,F=S.properties,E=S.value,B=E.merge(F),j=Ja(E,Object.keys(F));return e.set("value",B).set("properties",j);default:throw new Error('Unknown operation type: "'+t+'".')}}var Si={add_mark:["value","path","offset","length","mark"],insert_node:["value","path","node"],insert_text:["value","path","offset","text","marks"],merge_node:["value","path","position","properties","target"],move_node:["value","path","newPath"],remove_mark:["value","path","offset","length","mark"],remove_node:["value","path","node"],remove_text:["value","path","offset","text","marks"],set_mark:["value","path","offset","length","mark","properties"],set_node:["value","path","node","properties"],set_selection:["value","selection","properties"],set_value:["value","properties"],split_node:["value","path","position","properties","target"]},Fi={length:void 0,mark:void 0,marks:void 0,newPath:void 0,node:void 0,offset:void 0,path:void 0,position:void 0,properties:void 0,selection:void 0,target:void 0,text:void 0,type:void 0,value:void 0},Ei=function(e){function r(){return f(this,r),p(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return h(r,e),v(r,[{key:"apply",value:function(e){return Ni(e,this)}},{key:"invert",value:function(){return _i(this)}},{key:"toJSON",value:function(){var e=this.object,t=this.type,r={object:e,type:t},n=Si[t],o=!0,a=!1,i=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,l=this[c];if("document"!=c&&("selection"!=c&&"value"!=c&&("node"!=c||"insert_node"==t))){if("mark"!=c&&"marks"!=c&&"node"!=c&&"path"!=c&&"newPath"!=c||(l=l.toJSON()),"properties"==c&&"merge_node"==t){var f={};"data"in l&&(f.data=l.data.toJS()),"type"in l&&(f.type=l.type),l=f}if("properties"==c&&"set_mark"==t){var v={};"data"in l&&(v.data=l.data.toJS()),"type"in l&&(v.type=l.type),l=v}if("properties"==c&&"set_node"==t){var d={};"data"in l&&(d.data=l.data.toJS()),"type"in l&&(d.type=l.type),l=d}if("properties"==c&&"set_selection"==t){var h={};"anchor"in l&&(h.anchor=l.anchor.toJSON()),"focus"in l&&(h.focus=l.focus.toJSON()),"isFocused"in l&&(h.isFocused=l.isFocused),"marks"in l&&(h.marks=l.marks&&l.marks.toJSON()),l=h}if("properties"==c&&"set_value"==t){var y={};"data"in l&&(y.data=l.data.toJS()),"decorations"in l&&(y.decorations=l.decorations.toJS()),"schema"in l&&(y.schema=l.schema.toJS()),l=y}if("properties"==c&&"split_node"==t){var p={};"data"in l&&(p.data=l.data.toJS()),"type"in l&&(p.type=l.type),l=p}r[c]=l}}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}return r}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isOperation(e))return e;if(o(e))return r.fromJSON(e);throw new Error("`Operation.create` only accepts objects or operations, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e)||Array.isArray(e))return new t.List(e.map(r.create));throw new Error("`Operation.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(r.isOperation(e))return e;var t=e.type,n=Si[t],o={type:t};if(!n)throw new Error('`Operation.fromJSON` was passed an unrecognized operation type: "'+t+'"');var a=!0,i=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value,f=e[l];if(void 0===f){if("document"==l)continue;if("selection"==l)continue;if("value"==l)continue;if("node"==l&&"insert_node"!=t)continue;throw new Error('`Operation.fromJSON` was passed a "'+t+'" operation without the required "'+l+'" attribute.')}"path"!==l&&"newPath"!==l||(f=qe.create(f)),"mark"===l&&(f=N.create(f)),"marks"===l&&null!=f&&(f=N.createSet(f)),"node"===l&&(f=D.create(f)),"selection"===l&&(f=Za.create(f)),"value"===l&&(f=Ai.create(f)),"properties"===l&&"merge_node"===t&&(f=D.createProperties(f)),"properties"===l&&"set_mark"===t&&(f=N.createProperties(f)),"properties"===l&&"set_node"===t&&(f=D.createProperties(f)),"properties"===l&&"set_selection"===t&&(f=Za.createProperties(f)),"properties"===l&&"set_value"===t&&(f=Ai.createProperties(f)),"properties"===l&&"split_node"===t&&(f=D.createProperties(f)),o[l]=f}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}return new r(o)}},{key:"isOperationList",value:function(e){return t.List.isList(e)&&e.every(function(e){return r.isOperation(e)})}}]),r}(t.Record(Fi)),Bi=xe("slate:change"),ji=function(){function e(r){f(this,e);var n=r.value;this.value=n,this.operations=new t.List,this.tmp={dirty:[],merge:null,normalize:!0,save:!0}}return v(e,[{key:"applyOperation",value:function(e){var t=this.operations,r=this.value,n=r.history;o(e)&&(e=d({},e,{value:r})),e=Ei.create(e);var a=this.tmp,i=a.merge,s=a.save;null==i&&0!==t.size&&(i=!0),Bi("apply",{operation:e,save:s,merge:i}),r=e.apply(r),n&&s&&(n=n.save(e,{merge:i}),r=r.set("history",n));var u=function(e){var t=e.type,r=e.node,n=e.path,o=e.newPath;switch(t){case"add_mark":case"insert_text":case"remove_mark":case"remove_text":case"set_mark":case"set_node":return[n];case"insert_node":var a=r.getKeysToPathsTable(),i=Object.values(a).map(function(e){return n.concat(e)}),s=qe.lift(n);return[s,n].concat(m(i));case"split_node":var u=qe.lift(n),c=qe.increment(n);return[u,n,c];case"merge_node":var l=qe.lift(n),f=qe.decrement(n);return[l,f];case"move_node":var v=qe.lift(n),d=qe.lift(o);return qe.isSibling(n,o)||(d.size&&qe.isYounger(n,o)&&(d=qe.decrement(d,1,n.size-1)),v.size&&qe.isYounger(o,n)&&(v=qe.increment(v,1,o.size-1))),[v,d];case"remove_node":var h=qe.lift(n);return[h];default:return[]}}(e),c=this.tmp.dirty.reduce(function(t,r){r=qe.create(r);var n=qe.transform(r,e);return t=t.concat(n.toArray())},u);return this.tmp.dirty=c,this.value=r,this.operations=t.push(e),this}},{key:"applyOperations",value:function(e,t){var r=this;return e.forEach(function(e){return r.applyOperation(e,t)}),this}},{key:"call",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.apply(void 0,[this].concat(r)),this.normalizeDirtyPaths(),this}},{key:"normalize",value:function(){var e=this.value.document.getKeysToPathsTable(),t=Object.values(e).map(qe.create);return this.tmp.dirty=this.tmp.dirty.concat(t),this.normalizeDirtyPaths(),this}},{key:"normalizeDirtyPaths",value:function(){if(!this.tmp.normalize)return this;for(;this.tmp.dirty.length;){var e=this.tmp.dirty.pop();this.normalizeNodeByPath(e)}return this}},{key:"normalizeNodeByPath",value:function(e){var t=this,r=this.value,n=r.document,o=r.schema,a=n.assertNode(e),i=0,s=o.stack.plugins.length+o.rules.length+("text"===a.object?1:a.nodes.size);return this.withoutNormalizing(function(){!function r(){var u=a.normalize(o);if(u){u(t),n=t.value.document;var c=a.key,l=n.getDescendant(e);if(l&&l.key===c)a=l;else{if(!(l=n.getDescendant(c)))return;a=l,e=n.getPath(c)}if(++i>s)throw new Error("A schema rule could not be normalized after sufficient iterations. This is usually due to a `rule.normalize` or `plugin.normalizeNode` function of a schema being incorrectly written, causing an infinite loop.");r()}}()}),this}},{key:"withoutNormalizing",value:function(e){var t=this.tmp.normalize;return this.tmp.normalize=!1,e(this),this.tmp.normalize=t,this.normalizeDirtyPaths(),this}},{key:"withoutMerging",value:function(e){var t=this.tmp.merge;return this.tmp.merge=!1,e(this),this.tmp.merge=t,this}},{key:"withoutSaving",value:function(e){var t=this.tmp.save;return this.tmp.save=!1,e(this),this.tmp.save=t,this}},{key:"setOperationFlag",value:function(e,t){return c(!1,"As of slate@0.41.0 the `change.setOperationFlag` method has been deprecated."),this.tmp[e]=t,this}},{key:"getFlag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(!1,"As of slate@0.41.0 the `change.getFlag` method has been deprecated."),void 0!==t[e]?t[e]:this.tmp[e]}},{key:"unsetOperationFlag",value:function(e){return c(!1,"As of slate@0.41.0 the `change.unsetOperationFlag` method has been deprecated."),delete this.tmp[e],this}},{key:"withoutNormalization",value:function(e){return c(!1,"As of slate@0.41.0 the `change.withoutNormalization` helper has been renamed to `change.withoutNormalizing`."),this.withoutNormalizing(e)}}]),e}();function Pi(e,t){var r=!0,n=!1,o=void 0;try{for(var a,i=t[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value,u=!0,c=!1,l=void 0;try{for(var f,v=Object.getOwnPropertyNames(e)[Symbol.iterator]();!(u=(f=v.next()).done);u=!0){var d=f.value;if(!s.hasOwnProperty(d)){var h=Object.getOwnPropertyDescriptor(e,d);Object.defineProperty(s,d,h)}}}catch(e){c=!0,l=e}finally{try{!u&&v.return&&v.return()}finally{if(c)throw l}}var y=!0,p=!1,k=void 0;try{for(var m,g=Object.getOwnPropertyNames(e.prototype)[Symbol.iterator]();!(y=(m=g.next()).done);y=!0){var b=m.value;if(!s.prototype.hasOwnProperty(b)){h=Object.getOwnPropertyDescriptor(e.prototype,b);Object.defineProperty(s.prototype,b,h)}}}catch(e){p=!0,k=e}finally{try{!y&&g.return&&g.return()}finally{if(p)throw k}}}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}}function Ci(e){var t=qa[e],r="is"+(""+e.charAt(0).toUpperCase()+e.slice(1)),n=function(){function t(){f(this,t)}return v(t,[{key:"object",get:function(){return e}}]),t}();return n[r]=$a.bind(null,e),n.prototype[t]=!0,n}Object.keys(Oi).forEach(function(e){ji.prototype[e]=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return Bi(e,{args:r}),this.call.apply(this,[Oi[e]].concat(r)),this}}),Pi(Ci("block"),[I]),Pi(Ci("change"),[ji]),Pi(Ci("decoration"),[Wa]),Pi(Ci("document"),[A]),Pi(Ci("history"),[ii]),Pi(Ci("inline"),[O]),Pi(Ci("leaf"),[_]),Pi(Ci("mark"),[N]),Pi(Ci("node"),[D]),Pi(Ci("operation"),[Ei]),Pi(Ci("point"),[Ua]),Pi(Ci("range"),[Ga]),Pi(Ci("schema"),[di]),Pi(Ci("selection"),[Za]),Pi(Ci("stack"),[ui]),Pi(Ci("text"),[M]),Pi(Ci("value"),[Ai]),Pi(function(){function e(){f(this,e)}return v(e,[{key:"toJS",value:function(){return this.toJSON.apply(this,arguments)}}],[{key:"fromJS",value:function(){return this.fromJSON.apply(this,arguments)}}]),e}(),[I,ji,Wa,A,ii,O,_,N,D,Ei,Ua,Ga,di,Za,ui,M,Ai]);var Li,zi,Mi=function(){function e(){f(this,e)}return v(e,[{key:"getFirstInvalidNode",value:function(e){if("text"===this.object)return this.validate(e)?this:null;var t=null;return this.nodes.find(function(r){return t=r.validate(e)?r:r.getFirstInvalidNode(e)}),t}},{key:"getFirstText",value:function(){if("text"===this.object)return this;var e=null,t=this.nodes.find(function(t){return"text"===t.object||!!(e=t.getFirstText())});return e||t}},{key:"getKeysToPathsTable",value:function(){var e,t,r,n=(e={},t=this.key,r=[],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e);return this.nodes&&this.nodes.forEach(function(e,t){var r=e.getKeysToPathsTable();for(var o in r){var a=r[o];c(!(o in n),'A node with a duplicate key of "'+o+'" was found! Duplicate keys are not allowed, you should use `node.regenerateKey` before inserting if you are reusing an existing node.'),n[o]=[t].concat(m(a))}}),n}},{key:"getLastText",value:function(){if("text"===this.object)return this;var e=null,t=this.nodes.findLast(function(t){return"text"==t.object||(e=t.getLastText())});return e||t}},{key:"getNode",value:function(e){return(e=this.resolvePath(e))?"text"===this.object&&e.size?null:e.size?this.getDescendant(e):this:null}},{key:"getPath",value:function(e){if(t.List.isList(e))return e;var r=this.getKeysToPathsTable()[e];return r?t.List(r):null}},{key:"getText",value:function(){return("text"===this.object?this.leaves:this.nodes).reduce(function(e,t){return e+t.text},"")}},{key:"hasNode",value:function(e){return!!this.getNode(e)}},{key:"normalize",value:function(e){return e.normalizeNode(this)}},{key:"regenerateKey",value:function(){var e=u.create();return this.set("key",e)}},{key:"resolvePath",value:function(e,t){return"string"==typeof e?(e=this.getPath(e),null!=t&&(e=e.concat(t))):e=qe.create(e),e}},{key:"validate",value:function(e){return e.validateNode(this)}},{key:"text",get:function(){return this.getText()}}]),e}();P(Mi.prototype,["getFirstInvalidNode","getFirstText","getKeysToPathsTable","getLastText","getText","normalize","validate"]),Pi(Mi,[I,A,O,M]),Li=new RegExp("^[^---]*[A-Za-z--------]"),zi=new RegExp("^[^A-Za-z--------]*[---]");var Di=function(e){return e=e.toString(),zi.test(e)?"rtl":Li.test(e)?"ltr":"neutral"},Ri=function(){function e(){f(this,e)}return v(e,[{key:"addMark",value:function(e,t,r,n){var o=this.assertDescendant(e);return e=this.resolvePath(e),o=o.addMark(t,r,n),this.replaceNode(e,o)}},{key:"createDecoration",value:function(e){return e=Wa.createProperties(e),this.resolveDecoration(e)}},{key:"createPoint",value:function(e){return e=Ua.createProperties(e),this.resolvePoint(e)}},{key:"createRange",value:function(e){return e=Ga.createProperties(e),this.resolveRange(e)}},{key:"createSelection",value:function(e){return e=Za.createProperties(e),this.resolveSelection(e)}},{key:"filterDescendants",value:function(e){var r=[];return this.forEachDescendant(function(t,n,o){e(t,n,o)&&r.push(t)}),t.List(r)}},{key:"findDescendant",value:function(e){var t=null;return this.forEachDescendant(function(r,n,o){if(e(r,n,o))return t=r,!1}),t}},{key:"forEachDescendant",value:function(e){var t=void 0;return this.nodes.forEach(function(r,n,o){return!1===e(r,n,o)?(t=!1,!1):"text"!=r.object?t=r.forEachDescendant(e):void 0}),t}},{key:"getActiveMarksAtRange",value:function(e){if((e=this.resolveRange(e)).isUnset)return t.Set();if(e.isCollapsed){var r=e.start;return this.getMarksAtPosition(r.key,r.offset).toSet()}var n=e,o=n.start,a=n.end,i=o.key,s=o.offset,u=a.key,c=a.offset,l=this.getDescendant(i);if(i!==u){for(;i!==u&&0===c;){var f=this.getPreviousText(u);u=f.key,c=f.text.length}for(;i!==u&&s===l.text.length;)i=(l=this.getNextText(i)).key,s=0}if(i===u)return l.getActiveMarksBetweenOffsets(s,c);var v=l.getActiveMarksBetweenOffsets(s,l.text.length);if(0===v.size)return t.Set();var d=this.getDescendant(u).getActiveMarksBetweenOffsets(0,c),h=v.intersect(d);if(0===h.size)return h;for(var y=this.getNextText(i);y.key!==u;){if(0!==y.text.length&&0===(h=h.intersect(y.getActiveMarks())).size)return t.Set();y=this.getNextText(y.key)}return h}},{key:"getAncestors",value:function(e){var r=this;if(!(e=this.resolvePath(e)))return null;var n=[];return e.forEach(function(t,o){var a=e.slice(0,o),i=r.getNode(a);n.push(i)}),t.List(n)}},{key:"getBlocks",value:function(){var e=this.getBlocksAsArray();return t.List(e)}},{key:"getBlocksAsArray",value:function(){return this.nodes.reduce(function(e,t){return"block"!=t.object?e:t.isLeafBlock()?(e.push(t),e):e.concat(t.getBlocksAsArray())},[])}},{key:"getBlocksAtRange",value:function(e){var r=this.getBlocksAtRangeAsArray(e);return t.List(t.OrderedSet(r))}},{key:"getBlocksAtRangeAsArray",value:function(e){if((e=this.resolveRange(e)).isUnset)return[];var t=e,r=t.start,n=t.end,o=this.getClosestBlock(r.key);if(r.key===n.key)return[o];var a=this.getClosestBlock(n.key),i=this.getBlocksAsArray(),s=i.indexOf(o),u=i.indexOf(a);return i.slice(s,u+1)}},{key:"getBlocksByType",value:function(e){var r=this.getBlocksByTypeAsArray(e);return t.List(r)}},{key:"getBlocksByTypeAsArray",value:function(e){return this.nodes.reduce(function(t,r){return"block"!=r.object?t:r.isLeafBlock()&&r.type==e?(t.push(r),t):t.concat(r.getBlocksByTypeAsArray(e))},[])}},{key:"getChild",value:function(e){return(e=this.resolvePath(e))&&1===e.size?this.nodes.get(e.first()):null}},{key:"getClosest",value:function(e,t){var r=this,n=this.getAncestors(e);return n&&n.findLast(function(e){for(var n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return e!==r&&t.apply(void 0,[e].concat(o))})||null}},{key:"getClosestBlock",value:function(e){return this.getClosest(e,function(e){return"block"===e.object})}},{key:"getClosestInline",value:function(e){return this.getClosest(e,function(e){return"inline"===e.object})}},{key:"getClosestVoid",value:function(e,t){var r=this.getAncestors(e);return r?r.findLast(function(e){return t.isVoid(e)}):null}},{key:"getCommonAncestor",value:function(e,t){if(e=this.resolvePath(e),t=this.resolvePath(t),!e||!t)return null;var r=qe.relate(e,t);return this.getNode(r)}},{key:"getDecorations",value:function(e){var r=e.map("decorateNode",this).map(function(e){return Wa.createList(e)});return t.List(r).flatten(!0)}},{key:"getDepth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(e=this.resolvePath(e))&&this.getNode(e)?e.size-1+t:null}},{key:"getDescendant",value:function(e){if(!(e=this.resolvePath(e)))return null;var t=e.flatMap(function(e){return["nodes",e]});return this.getIn(t)}},{key:"getFragmentAtRange",value:function(e){if((e=this.resolveRange(e)).isUnset)return A.create();for(var t=e,r=t.start,n=t.end,o=this,a=n.path,i=n.offset,s="end";a.size;){var u=a.last();o=o.splitNode(a,i),i=u+1,(a=qe.lift(a)).size||"end"!==s||(a=r.path,i=r.offset,s="start")}var c=r.path.first()+1,l=n.path.first()+2,f=o.nodes.slice(c,l);return A.create({nodes:f})}},{key:"getFurthest",value:function(e,t){var r=this,n=this.getAncestors(e);return n&&n.find(function(e){for(var n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return e!==r&&t.apply(void 0,[e].concat(o))})||null}},{key:"getFurthestAncestor",value:function(e){return(e=this.resolvePath(e))&&e.size?this.nodes.get(e.first()):null}},{key:"getFurthestBlock",value:function(e){return this.getFurthest(e,function(e){return"block"===e.object})}},{key:"getFurthestInline",value:function(e){return this.getFurthest(e,function(e){return"inline"===e.object})}},{key:"getFurthestOnlyChildAncestor",value:function(e){var t=this.getAncestors(e);return t&&t.rest().reverse().takeUntil(function(e){return e.nodes.size>1}).last()||null}},{key:"getInlines",value:function(){var e=this.getInlinesAsArray();return t.List(e)}},{key:"getInlinesAsArray",value:function(){var e=[];return this.nodes.forEach(function(t){"text"!=t.object&&(t.isLeafInline()?e.push(t):e=e.concat(t.getInlinesAsArray()))}),e}},{key:"getInlinesAtRange",value:function(e){var r=this.getInlinesAtRangeAsArray(e);return t.List(t.OrderedSet(r))}},{key:"getInlinesAtRangeAsArray",value:function(e){var t=this;return(e=this.resolveRange(e)).isUnset?[]:this.getTextsAtRangeAsArray(e).map(function(e){return t.getClosestInline(e.key)}).filter(function(e){return e})}},{key:"getInlinesByType",value:function(e){var r=this.getInlinesByTypeAsArray(e);return t.List(r)}},{key:"getInlinesByTypeAsArray",value:function(e){return this.nodes.reduce(function(t,r){return"text"==r.object?t:r.isLeafInline()&&r.type==e?(t.push(r),t):t.concat(r.getInlinesByTypeAsArray(e))},[])}},{key:"getInsertMarksAtRange",value:function(e){var r=(e=this.resolveRange(e)).start;return e.isUnset?t.Set():e.isCollapsed?this.getMarksAtPosition(r.key,r.offset):this.getDescendant(r.key).getMarksAtIndex(r.offset+1)}},{key:"getMarks",value:function(){var e=this.getMarksAsArray();return t.Set(e)}},{key:"getMarksAsArray",value:function(){var e,t=[];return this.nodes.forEach(function(e){t.push(e.getMarksAsArray())}),(e=[]).concat.apply(e,t)}},{key:"getMarksAtPosition",value:function(e,r){var n=this.getDescendant(e).getMarksAtIndex(r);if(0!==r)return n;var o=this.getClosestBlock(e);if(""===o.text)return n;var a=this.getPreviousText(e);return a?o.hasDescendant(a.key)?a.getMarksAtIndex(a.text.length):n:t.Set()}},{key:"getMarksAtRange",value:function(e){return t.Set(this.getOrderedMarksAtRange(e))}},{key:"getMarksByType",value:function(e){var r=this.getMarksByTypeAsArray(e);return t.Set(r)}},{key:"getMarksByTypeAsArray",value:function(e){return this.nodes.reduce(function(t,r){return"text"==r.object?t.concat(r.getMarksAsArray().filter(function(t){return t.type==e})):t.concat(r.getMarksByTypeAsArray(e))},[])}},{key:"getNextBlock",value:function(e){var t=this.assertDescendant(e),r=void 0;"block"==t.object?r=t.getLastText():r=this.getClosestBlock(e).getLastText();var n=this.getNextText(r.key);return n?this.getClosestBlock(n.key):null}},{key:"getNextNode",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;for(var t=e.size;t>0;t--){var r=e.slice(0,t),n=qe.increment(r),o=this.getNode(n);if(o)return o}return null}},{key:"getNextSibling",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;var t=qe.increment(e);return this.getNode(t)}},{key:"getNextText",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;var t=this.getNextNode(e);return t?t.getFirstText():null}},{key:"getOffset",value:function(e){this.assertDescendant(e);var t=this.getFurthestAncestor(e),r=this.nodes.takeUntil(function(e){return e==t}).reduce(function(e,t){return e+t.text.length},0);return this.hasChild(e)?r:r+t.getOffset(e)}},{key:"getOffsetAtRange",value:function(e){if((e=this.resolveRange(e)).isUnset)throw new Error("The range cannot be unset to calculcate its offset.");if(e.isExpanded)throw new Error("The range must be collapsed to calculcate its offset.");var t=e.start;return this.getOffset(t.key)+t.offset}},{key:"getOrderedMarks",value:function(){var e=this.getMarksAsArray();return t.OrderedSet(e)}},{key:"getOrderedMarksAtRange",value:function(e){var r=e=this.resolveRange(e),n=r.start,o=r.end;return e.isUnset?t.OrderedSet():e.isCollapsed?this.getMarksAtPosition(n.key,n.offset):this.getOrderedMarksBetweenPositions(n.key,n.offset,o.key,o.offset)}},{key:"getOrderedMarksBetweenPositions",value:function(e,r,n,o){if(e===n)return this.getDescendant(e).getMarksBetweenOffsets(r,o);var a=this.getTextsBetweenPositionsAsArray(e,n);return t.OrderedSet().withMutations(function(t){a.forEach(function(a){a.key===e?t.union(a.getMarksBetweenOffsets(r,a.text.length)):a.key===n?t.union(a.getMarksBetweenOffsets(0,o)):t.union(a.getMarks())})})}},{key:"getOrderedMarksByType",value:function(e){var r=this.getMarksByTypeAsArray(e);return t.OrderedSet(r)}},{key:"getParent",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;var t=qe.lift(e);return this.getNode(t)}},{key:"getPreviousBlock",value:function(e){var t=this.assertDescendant(e),r=void 0;"block"==t.object?r=t.getFirstText():r=this.getClosestBlock(e).getFirstText();var n=this.getPreviousText(r.key);return n?this.getClosestBlock(n.key):null}},{key:"getPreviousNode",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;for(var t=e.size;t>0;t--){var r=e.slice(0,t);if(0!==r.last()){var n=qe.decrement(r),o=this.getNode(n);if(o)return o}}return null}},{key:"getPreviousSibling",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;if(0===e.last())return null;var t=qe.decrement(e);return this.getNode(t)}},{key:"getPreviousText",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;var t=this.getPreviousNode(e);return t?t.getLastText():null}},{key:"getSelectionIndexes",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.start,n=e.end;if(!t)return null;if(e.isUnset)return null;if(r.key==n.key){var o=this.getFurthestAncestor(r.key),a=o?this.nodes.indexOf(o):null;return{start:a,end:a+1}}var i=null,s=null;return this.nodes.forEach(function(e,t){return"text"==e.object?(null==i&&e.key==r.key&&(i=t),null==s&&e.key==n.key&&(s=t+1)):(null==i&&e.hasDescendant(r.key)&&(i=t),null==s&&e.hasDescendant(n.key)&&(s=t+1)),null==i||null==s}),t&&null==i&&(i=0),t&&null==s&&(s=this.nodes.size),null==i?null:{start:i,end:s}}},{key:"getTextAtOffset",value:function(e){if(0===e)return this.getFirstText();if(e===this.text.length)return this.getLastText();if(e<0||e>this.text.length)return null;var t=0;return this.getTexts().find(function(r,n,o){return(t+=r.text.length)>e})}},{key:"getTextDirection",value:function(){var e=Di(this.text);return"neutral"===e?null:e}},{key:"getTexts",value:function(){var e=this.getTextsAsArray();return t.List(e)}},{key:"getTextsAsArray",value:function(){var e=[];return this.nodes.forEach(function(t){"text"==t.object?e.push(t):e=e.concat(t.getTextsAsArray())}),e}},{key:"getTextsAtRange",value:function(e){if((e=this.resolveRange(e)).isUnset)return t.List();var r=e,n=r.start,o=r.end;return t.List(this.getTextsBetweenPositionsAsArray(n.key,o.key))}},{key:"getTextsAtRangeAsArray",value:function(e){if((e=this.resolveRange(e)).isUnset)return[];var t=e,r=t.start,n=t.end;return this.getTextsBetweenPositionsAsArray(r.key,n.key)}},{key:"getTextsBetweenPositionsAsArray",value:function(e,t){var r=this.getDescendant(e);if(e==t)return[r];var n=this.getDescendant(t),o=this.getTextsAsArray(),a=o.indexOf(r),i=o.indexOf(n,a);return o.slice(a,i+1)}},{key:"hasBlockChildren",value:function(){return!(!this.nodes||!this.nodes.find(function(e){return"block"===e.object}))}},{key:"hasChild",value:function(e){return!!this.getChild(e)}},{key:"hasInlineChildren",value:function(){return!(!this.nodes||!this.nodes.find(function(e){return"inline"===e.object||"text"===e.object}))}},{key:"hasDescendant",value:function(e){return!!this.getDescendant(e)}},{key:"hasVoidParent",value:function(e,t){return!!this.getClosestVoid(e,t)}},{key:"insertNode",value:function(e,t){var r=(e=this.resolvePath(e)).last(),n=qe.lift(e),o=this.assertNode(n),a=o.nodes.splice(r,0,t);return o=o.set("nodes",a),this.replaceNode(n,o)}},{key:"insertText",value:function(e,t,r,n){var o=this.assertDescendant(e);return e=this.resolvePath(e),o=o.insertText(t,r,n),this.replaceNode(e,o)}},{key:"isLeafBlock",value:function(){var e=this.object,t=this.nodes.first();return"block"===e&&"block"!==t.object}},{key:"isLeafInline",value:function(){var e=this.object,t=this.nodes.first();return"inline"===e&&"inline"!==t.object}},{key:"mapChildren",value:function(e){var t=this,r=this.nodes;return r.forEach(function(n,o){var a=e(n,o,t.nodes);a!==n&&(r=r.set(a.key,a))}),this.set("nodes",r)}},{key:"mapDescendants",value:function(e){var t=this,r=this.nodes;return r.forEach(function(n,o){var a=n;"text"!==a.object&&(a=a.mapDescendants(e)),(a=e(a,o,t.nodes))!==n&&(r=r.set(o,a))}),this.set("nodes",r)}},{key:"mergeNode",value:function(e){var t=this.assertNode(e);if(0===(e=this.resolvePath(e)).last())throw new Error("Unable to merge node because it has no previous sibling: "+t);var r=qe.decrement(e),n=this.assertNode(r);if(n.object!==t.object)throw new Error("Unable to merge two different kinds of nodes: "+n+" and "+t);var o="text"===n.object?n.mergeText(t):n.set("nodes",n.nodes.concat(t.nodes)),a=this;return a=(a=(a=a.removeNode(e)).removeNode(r)).insertNode(r,o)}},{key:"moveNode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.assertNode(e);e=this.resolvePath(e),t=this.resolvePath(t,r);var o=qe.lift(t);this.assertNode(o);var a=qe.crop(e,t),i=k(a,2),s=i[0],u=i[1],c=qe.compare(s,u);e.size<t.size&&-1===c&&(t=qe.decrement(t,1,s.size-1));var l=this;return l=(l=l.removeNode(e)).insertNode(t,n)}},{key:"removeMark",value:function(e,t,r,n){var o=this.assertDescendant(e);return e=this.resolvePath(e),o=o.removeMark(t,r,n),this.replaceNode(e,o)}},{key:"removeNode",value:function(e){this.assertDescendant(e);var t=(e=this.resolvePath(e)).flatMap(function(e){return["nodes",e]});return this.deleteIn(t)}},{key:"removeText",value:function(e,t,r){var n=this.assertDescendant(e);return n=n.removeText(t,r.length),this.replaceNode(e,n)}},{key:"replaceNode",value:function(e,t){if(!(e=this.resolvePath(e)))throw new Error("Unable to replace a node because it could not be found in the first place: "+e);if(!e.size)return t;this.assertNode(e);var r=e.flatMap(function(e){return["nodes",e]});return this.setIn(r,t)}},{key:"resolveDecoration",value:function(e){return e=(e=Wa.create(e)).normalize(this)}},{key:"resolvePoint",value:function(e){return e=(e=Ua.create(e)).normalize(this)}},{key:"resolveRange",value:function(e){return e=(e=Ga.create(e)).normalize(this)}},{key:"resolveSelection",value:function(e){return e=(e=Za.create(e)).normalize(this)}},{key:"setNode",value:function(e,t){var r=this.assertNode(e);return r=r.merge(t),this.replaceNode(e,r)}},{key:"setMark",value:function(e,t,r,n,o){var a=this.assertNode(e);return a=a.updateMark(t,r,n,o),this.replaceNode(e,a)}},{key:"splitNode",value:function(e,t,r){var n=this.assertNode(e);e=this.resolvePath(e);var o=void 0,a=void 0;if("text"===n.object){var i=n.splitText(t),s=k(i,2);o=s[0],a=s[1]}else{var u=n.nodes.take(t),c=n.nodes.skip(t);o=n.set("nodes",u),a=n.set("nodes",c).regenerateKey()}r&&"text"!==n.object&&(a=a.merge(r));var l=this;return l=(l=(l=l.removeNode(e)).insertNode(e,a)).insertNode(e,o)}}]),e}(),Ii=function(e){Ri.prototype["assert"+e]=function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=this["get"+e].apply(this,[t].concat(n));if(null==a)throw new Error("`Node.assert"+e+"` could not find node with path or key: "+t);return a}},Ji=!0,Ki=!1,Ui=void 0;try{for(var Vi,Wi=["Child","Depth","Descendant","Node","Parent","Path"][Symbol.iterator]();!(Ji=(Vi=Wi.next()).done);Ji=!0){Ii(Vi.value)}}catch(e){Ki=!0,Ui=e}finally{try{!Ji&&Wi.return&&Wi.return()}finally{if(Ki)throw Ui}}P(Ri.prototype,["getBlocksAsArray","getBlocksAtRangeAsArray","getBlocksByTypeAsArray","getDecorations","getFragmentAtRange","getInlinesAsArray","getInlinesAtRangeAsArray","getInlinesByTypeAsArray","getMarksAsArray","getMarksAtPosition","getOrderedMarksBetweenPositions","getInsertMarksAtRange","getMarksByTypeAsArray","getNextBlock","getOffset","getOffsetAtRange","getPreviousBlock","getTextAtOffset","getTextDirection","getTextsAsArray","getTextsBetweenPositionsAsArray"]),Pi(Ri,[I,A,O]),Pi(function(){function e(){f(this,e)}return v(e,[{key:"flip",value:function(){return this.setPoints([this.focus,this.anchor])}},{key:"moveForward",value:function(e){return this.updatePoints(function(t){return t.moveForward(e)})}},{key:"moveBackward",value:function(e){return this.updatePoints(function(t){return t.moveBackward(e)})}},{key:"moveAnchorBackward",value:function(e){return this.setAnchor(this.anchor.moveBackward(e))}},{key:"moveAnchorForward",value:function(e){return this.setAnchor(this.anchor.moveForward(e))}},{key:"moveAnchorTo",value:function(e,t){return this.setAnchor(this.anchor.moveTo(e,t))}},{key:"moveAnchorToStartOfNode",value:function(e){return this.setAnchor(this.anchor.moveToStartOfNode(e))}},{key:"moveAnchorToEndOfNode",value:function(e){return this.setAnchor(this.anchor.moveToEndOfNode(e))}},{key:"moveEndBackward",value:function(e){return this.setEnd(this.end.moveBackward(e))}},{key:"moveEndForward",value:function(e){return this.setEnd(this.end.moveForward(e))}},{key:"moveEndTo",value:function(e,t){return this.setEnd(this.end.moveTo(e,t))}},{key:"moveEndToStartOfNode",value:function(e){return this.setEnd(this.end.moveToStartOfNode(e))}},{key:"moveEndToEndOfNode",value:function(e){return this.setEnd(this.end.moveToEndOfNode(e))}},{key:"moveFocusBackward",value:function(e){return this.setFocus(this.focus.moveBackward(e))}},{key:"moveFocusForward",value:function(e){return this.setFocus(this.focus.moveForward(e))}},{key:"moveFocusTo",value:function(e,t){return this.setFocus(this.focus.moveTo(e,t))}},{key:"moveFocusToStartOfNode",value:function(e){return this.setFocus(this.focus.moveToStartOfNode(e))}},{key:"moveFocusToEndOfNode",value:function(e){return this.setFocus(this.focus.moveToEndOfNode(e))}},{key:"moveStartBackward",value:function(e){return this.setStart(this.start.moveBackward(e))}},{key:"moveStartForward",value:function(e){return this.setStart(this.start.moveForward(e))}},{key:"moveStartTo",value:function(e,t){return this.setStart(this.start.moveTo(e,t))}},{key:"moveStartToStartOfNode",value:function(e){return this.setStart(this.start.moveToStartOfNode(e))}},{key:"moveStartToEndOfNode",value:function(e){return this.setStart(this.start.moveToEndOfNode(e))}},{key:"moveTo",value:function(e,t){return this.updatePoints(function(r){return r.moveTo(e,t)})}},{key:"moveToAnchor",value:function(){return this.setFocus(this.anchor)}},{key:"moveToEnd",value:function(){return this.setStart(this.end)}},{key:"moveToEndOfNode",value:function(e){return this.updatePoints(function(t){return t.moveToEndOfNode(e)})}},{key:"moveToFocus",value:function(){return this.setAnchor(this.focus)}},{key:"moveToRangeOfNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this.setPoints([this.anchor.moveToStartOfNode(e),this.focus.moveToEndOfNode(t)])}},{key:"moveToStart",value:function(){return this.setEnd(this.start)}},{key:"moveToStartOfNode",value:function(e){return this.updatePoints(function(t){return t.moveToStartOfNode(e)})}},{key:"normalize",value:function(e){return this.updatePoints(function(t){return t.normalize(e)})}},{key:"setAnchor",value:function(e){return this.set("anchor",e)}},{key:"setEnd",value:function(e){return this.isBackward?this.setAnchor(e):this.setFocus(e)}},{key:"setFocus",value:function(e){return this.set("focus",e)}},{key:"setPoints",value:function(e){var t=k(e,2),r=t[0],n=t[1];return this.set("anchor",r).set("focus",n)}},{key:"updatePoints",value:function(e){var t=this.anchor,r=this.focus;return t=e(t),r=e(r),this.merge({anchor:t,focus:r})}},{key:"setStart",value:function(e){return this.isBackward?this.setFocus(e):this.setAnchor(e)}},{key:"setProperties",value:function(e){var t=e=Ga.createProperties(e),r=t.anchor,n=t.focus,o=y(t,["anchor","focus"]);return r&&(o.anchor=Ua.create(r)),n&&(o.focus=Ua.create(n)),this.merge(o)}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{object:this.object,anchor:this.anchor.toJSON(e),focus:this.focus.toJSON(e)}}},{key:"toRange",value:function(){var e=Ga.createProperties(this);return Ga.create(e)}},{key:"unset",value:function(){return this.updatePoints(function(e){return e.unset()})}},{key:"isCollapsed",get:function(){return this.anchor===this.focus||this.anchor.key===this.focus.key&&this.anchor.offset===this.focus.offset}},{key:"isExpanded",get:function(){return!this.isCollapsed}},{key:"isBackward",get:function(){var e=this.isUnset,t=this.anchor,r=this.focus;return e?null:t.key===r.key?t.offset>r.offset:qe.isBefore(r.path,t.path)}},{key:"isForward",get:function(){var e=this.isBackward;return null==e?null:!e}},{key:"isUnset",get:function(){var e=this.anchor,t=this.focus;return e.isUnset||t.isUnset}},{key:"isSet",get:function(){return!this.isUnset}},{key:"start",get:function(){return this.isBackward?this.focus:this.anchor}},{key:"end",get:function(){return this.isBackward?this.anchor:this.focus}}]),e}(),[Wa,Ga,Za]);var qi={apply:Ni,invert:_i},$i={Block:I,Changes:Oi,Data:g,Decoration:Wa,Document:A,History:ii,Inline:O,KeyUtils:u,Leaf:_,Mark:N,Node:D,Operation:Ei,Operations:qi,PathUtils:qe,Point:Ua,Range:Ga,resetMemoization:C,Schema:di,Selection:Za,Stack:ui,Text:M,TextUtils:Le,useMemoization:L,Value:Ai};e.Block=I,e.Change=ji,e.Changes=Oi,e.Data=g,e.Decoration=Wa,e.Document=A,e.History=ii,e.Inline=O,e.KeyUtils=u,e.Leaf=_,e.Mark=N,e.Node=D,e.Operation=Ei,e.Operations=qi,e.PathUtils=qe,e.Point=Ua,e.Range=Ga,e.resetMemoization=C,e.Schema=di,e.Selection=Za,e.Stack=ui,e.Text=M,e.TextUtils=Le,e.useMemoization=L,e.Value=Ai,e.default=$i,Object.defineProperty(e,"__esModule",{value:!0})});
